<!DOCTYPE html>
<html data-html-server-rendered="true" lang="zh-Hans" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22zh-Hans%22%7D%7D">
  <head>
    <title>Mark 并调试 HEU 自动打卡代码 - Monstx&#x27;s Blog</title><meta name="gridsome:hash" content="e8b353b2ca9703e8f4d015acaca05f979017da81"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="theme-color" content="#dee1e6"><meta data-vue-tag="ssr" name="apple-mobile-web-app-capable" content="yes"><meta data-vue-tag="ssr" name="apple-mobile-web-app-status-bar-style" content="default"><meta data-vue-tag="ssr" name="apple-mobile-web-app-title" content="Monstx&#x27;s Blog"><meta data-vue-tag="ssr" name="application-name" content="Monstx&#x27;s Blog"><meta data-vue-tag="ssr" name="msapplication-TileColor" content="#fafafa"><meta data-vue-tag="ssr" name="msapplication-TileImage" content="/assets/icons/msapplication-icon-144x144.png"><meta data-vue-tag="ssr" data-key="og:type" property="og:type" content="website"><meta data-vue-tag="ssr" data-key="og:title" property="og:title" content="Mark 并调试 HEU 自动打卡代码"><meta data-vue-tag="ssr" data-key="og:description" property="og:description" content="找资料逛博客的时候碰巧进入了一个学长的博客，发现了懒人福音的自动打卡 Python 脚本。本文记录 Python 萌新的调试过程（造轮子不行，用轮子一流.."><meta data-vue-tag="ssr" data-key="og:url" property="og:url" content="https://blog.monsterx.cn/code/heu-auto-checkin-covid19/"><meta data-vue-tag="ssr" data-key="og:image" property="og:image" content="https://blog.monsterx.cn/OG/auto-checkin-covid19.png"><meta data-vue-tag="ssr" data-key="twitter:card" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" data-key="twitter:site" name="twitter:site" content="@monsterxcn"><meta data-vue-tag="ssr" data-key="twitter:creator" name="twitter:creator" content="@monsterxcn"><meta data-vue-tag="ssr" data-key="twitter:title" name="twitter:title" content="Mark 并调试 HEU 自动打卡代码"><meta data-vue-tag="ssr" data-key="twitter:description" name="twitter:description" content="找资料逛博客的时候碰巧进入了一个学长的博客，发现了懒人福音的自动打卡 Python 脚本。本文记录 Python 萌新的调试过程（造轮子不行，用轮子一流.."><meta data-vue-tag="ssr" data-key="twitter:image" name="twitter:image" content="https://blog.monsterx.cn/OG/auto-checkin-covid19.png"><meta data-vue-tag="ssr" data-key="description" name="description" itemprop="description" content="找资料逛博客的时候碰巧进入了一个学长的博客，发现了懒人福音的自动打卡 Python 脚本。本文记录 Python 萌新的调试过程（造轮子不行，用轮子一流.."><meta data-vue-tag="ssr" data-key="name" itemprop="name" content="Mark 并调试 HEU 自动打卡代码"><meta data-vue-tag="ssr" data-key="image" itemprop="image" content="https://blog.monsterx.cn/OG/auto-checkin-covid19.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.bf61008f0ef71b874a75ec950abb49a1.png"><link data-vue-tag="ssr" rel="manifest" href="/manifest.json"><link data-vue-tag="ssr" rel="mask-icon" href="./src/favicon.svg" color="#fafafa"><link rel="preload" href="/assets/css/styles.c57c7a80.css" as="style"><link rel="preload" href="/assets/js/app.797b8a92.js" as="script"><link rel="preload" href="/assets/css/8.styles.ade877ec.css" as="style"><link rel="preload" href="/assets/js/page--src--templates--blog-post-vue.2214437c.js" as="script"><link rel="prefetch" href="/assets/css/0.styles.d71c1498.css"><link rel="prefetch" href="/assets/css/10.styles.c4971a30.css"><link rel="prefetch" href="/assets/css/11.styles.b0fdc089.css"><link rel="prefetch" href="/assets/css/2.styles.2931a0ed.css"><link rel="prefetch" href="/assets/css/3.styles.41d1c847.css"><link rel="prefetch" href="/assets/css/4.styles.6c65bb1e.css"><link rel="prefetch" href="/assets/css/5.styles.aa09ecc1.css"><link rel="prefetch" href="/assets/css/6.styles.e7f158b2.css"><link rel="prefetch" href="/assets/css/7.styles.bd4fcc6c.css"><link rel="prefetch" href="/assets/css/9.styles.c4971a30.css"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.142a20d9.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.97ce8267.js"><link rel="prefetch" href="/assets/js/page--src--pages--archives-vue.5b18e314.js"><link rel="prefetch" href="/assets/js/page--src--pages--friends-vue.d0cd2cb9.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.ac62872d.js"><link rel="prefetch" href="/assets/js/page--src--pages--watch-vue.c94125ea.js"><link rel="prefetch" href="/assets/js/page--src--templates--category-vue.10a689ca.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.3ed726df.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--about-vue~page--src--pages--watch-vue~page--src--templates--blog-post-vue.f2998938.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--blog-post-vue.d12d4242.js"><link rel="stylesheet" href="/assets/css/styles.c57c7a80.css"><link rel="stylesheet" href="/assets/css/8.styles.ade877ec.css"><script data-vue-tag="ssr" type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","description":"找资料逛博客的时候碰巧进入了一个学长的博客，发现了懒人福音的自动打卡 Python 脚本。本文记录 Python 萌新的调试过程（造轮子不行，用轮子一流..","datePublished":"April 5, 2020","author":{"name":"monsterxcn"},"headline":"Mark 并调试 HEU 自动打卡代码","image":"https://blog.monsterx.cn/OG/auto-checkin-covid19.png"}</script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      ;(function () {
        window.__onThemeChange = function () {}
        function setTheme(newTheme) {
          window.__theme = newTheme
          preferredTheme = newTheme
          document.body.setAttribute('data-theme', newTheme)
          window.__onThemeChange(newTheme)
        }

        var preferredTheme
        try {
          preferredTheme = localStorage.getItem('theme')
        } catch (err) {}

        window.__setPreferredTheme = function (newTheme) {
          setTheme(newTheme)
          try {
            localStorage.setItem('theme', newTheme)
          } catch (err) {}
        }

        var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
        darkQuery.addListener(function (e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        })

        setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
      })()
    </script>

    <div id="app" data-server-rendered="true"><div id="nprogress-container"><header class="header"><div class="header__left"><div><a href="/" class="logo active"><span class="logo__text">
      ⟁   Monstx's Blog
    </span></a></div></div><div class="header__right"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></div></header></div><main class="main"><div><div class="post-title"><h1 class="post-title__text">
      Mark 并调试 HEU 自动打卡代码
      <!----></h1><div class="post-meta">
  April 5, 2020 ·
  
    3549 words ·
    <strong> 11 min read</strong></div></div><div class="post content-box"><div class="post__header"><img alt="Cover image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-e9f822d21a3f4fb948604bebd5e5f005'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-e9f822d21a3f4fb948604bebd5e5f005)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAJOElEQVRIx21XWW8b1xXmD0lbicNluO8iKVLiNpzh7Jwhh8NNi2VqsyxZuy1brpfYlpLa9ZI6dpM0St04TaIoCWKrSWqgqJHABtrYTVsUbZ8KJH1o6vil7Q/ombnkiLYDXAwOee%2bc%2bc4531muCXNQsCzOgsPHdcm81VXAnCBT2v/OQq%2bdhJ/uAI97GLND%2b2l103DG6qLhPLxlximbm7G5aaQEZNzLdmQa97aVw3kkg2ZdZo2PwivoAPoJT7uHRQIsgIG2kGx8yGS8r%2bsqoEPGE/4HZLiX7usvclxVKTdKcoPlquGoAAd6bKSui0FK7B4GPmkARTIYCUqQKvRVENDnQHMHEL8H1M93A9VlbQvOG84CPZoSXbMJ7ekb5NOG%2bnlwdrCPK8nVqtqoq82a2lTK1UpZrapNhlFiCcHhZRAg4y1ArIMjkRlOP2%2bYhGTkewDdbQwyz9DThtiOA9MJMgnRM3wPb8Ey6aBZjTAOZBxjOAz30OEYVypVVaVWLlXLJRWeJVmFBUJNrecIudfeJgwC1E0SZIyuEIXUAMcYJLFo5MwjcLBrxARMNQLbDRqiqmOjDK8hChW%2bi2SML8RwXFmWFKlYKYplgZOkogLoZVhFBf4XRcXlA3x7Gg0KWbQ4dJJK872gsRE%2b5CyADB/SkspBpclRVpzKM%2bMUP1HgJ4KxMliiIdPNQ1iNpNKVkx1/tZWbEEe7SdYha8EfolmmKPAyLJoWSJIFG0ShBIvjJJ6XZakcT4o29x7vjTh0kkojjMWetTnzmD1rdRAYTlgd%2bV5r1hUArTNldY4Rp7LkEMm0iuVZWZ0lmJZVR2nG87iPt3t5DNgIkCCp2goLemBpFNjuHEAkY2EPuSGRJJkCT5Ecy4g0xazPHzizOCHyRbogqFKJoXmOFbNE8akERYHWZC2wJB4oYuRxc/8kFttvJ1atfcPmYM0arrPDzxcXbmQr6%2bmxl9O1s5nRy%2bTszTBxgBm/3EfN9iZmrMlpjDiGZdcsyRlbfs0crGrGuxjcx3UnVdsAg3AgtOPgogOhDElQilTK5uifnFn739/u/PXXb8y1RlJp%2bvqZlWFFJkkukxUQfUEXCrdFIwmqKgUMz9vDFYzdwLgfmdWfY%2bJFTN3qEa%2bERl4nxy4lx7eofReCynk7fdouvOjf91a%2bup6rnVJa59ziprVwEiucxphNa3rRVryIBVWLbgCqrR2mMCajfoELYQ/QoIqOewWrc3BiSP3y1vWGWv3xidXPt69%2bfX976/wPi4L874e3NlZnMlk6n29HoKt6UEaV0JQ7aSCPPToEXsdcLOYtOiIqWzoUTQ0R4lwstz%2bYbNClBYKdcidGUlSr3FyRq/MDhaket2j1l2x9Q5hHxMINi78MRcXc1anaOQBFqqvdsEZpg/9dvkyRF/7%2byavXNo9f3zz%2b1f33vnl4%2b%2b72te2fvvjowYfnT6yAAam04A0JhhdQghrVoy07KbsLGJWH1LQ4SLubrg0tFZVZSZnhpalqc2lpZXN%2b6RzIsjrHFqcbo6usOPk9cwZOOr2MlgPge9RSOwYg2FoOoFQwzNATEZ0jzXbCbA0fX5j86t7OF7tbQKHHf/rVvx7eevzH3TtvXqpXqgTBuwO0xYiAkzI7nqjcbTOg/thBWx4AAQ6woVJfqNTm4SlVZgX5wPDYWnN0mZOmy9V5SZkbGTsMpen7WAYw6DGkjEqDFKL2iqqt6YnK3dXewQyKa01NLy4tr23fvPH7OzuP/nDr0Ze3v3l46z9/%2bfgXV84GwmQswds97eINueXw0IFg4dnKjfsFZ7iMByRPrO7uq7r6VL6yINTXxPqRJLEvSU2W64tS80g0O0aJM5lCi5QXs8yEO1aHk3Z/0e4TvDHI4DzWrpac0eMgJUzGl/TCx6GpBswQpKGpmcXRiTlWbg5PLt77ZOfxgw%2b/vr/z7cOP/vvn22PN1nOWrDvIId%2bDj3vwAjHIVmihF6c6DR9GIwYc7x8cG1RODpaO9RfX0tUzcX45X1pqLr9WmdwsT54vz13Pq8fokXOUerQ2taHsPzO08npSPjogr8e4ZXe0BqUp09hwBEsQQMsz/DR1t/pOHLTy5/EnfJHBaIoJxHLTc6t3t6//8/Ob337x/j/u3jy1vNqLa0FEvtc6oM6NMkkLObbX0RmNtNbD9dpy3sQwMXohQs700YeSpXUABH5VZ6/w6jLfONo4fIOvHZH2nWbr68XRU8PLr8qTF%2bLiWpicCeWmPRElMLgvxq9aPRyut2EjsKghmIyURRuY1goYX7wZjJe8wf5gdDAYzx04dPiDl09/9trRt186OToyHklIKUIdzCqGpyECQoYa4ahGgRqIUUZb0Pzipl0h2R2t%2b1P7cZ/gDsnOSKXHmnVHymL5oFxfATMEdUlUDgnVZbm2mCLHHCEFmAasg5M2DwfQ7eBZvTV1T25oNDIZVcmi93xvtB4aHIvnD/ZT833pMW8o7fRGhvYffPfyiTePD3t8EXcg3j%2bQSedIilGhB4ObgTMeL1mlciqZq8Mzn4UJ74mZGaoz1AMbAZ%2bAhgpsRtSCA30JpcC10vnhXGEsS44EoqUeWw56MOw6NKAUAto986KJwehaJmN8gL7jjTXC6YlwajyUaoVTrUh6KpxuOXypgli9cGz%2b7DifSiatzgCGe%2bKJtC8M9wStfAH74xFCzaVKmZSSS0nplM2lzVddo1FB73SCkWydTkfBJIeQgfADK2HzMF3jzN5YuRfqPQoBPxngsJYD%2bhhI4j7JGxvyRJvw9KEVH4bljlSSWfHqqYVXDpdvXz0aCEVd3mA0KVjdWusF6gPpE305aTAmDCSkdJJJDlidT1Xk9oxt3DTad5fO/IyuTU81EJRjhu91hFx310LeaVchrYsFSvaggsMKVfCQ6gipzrDqCNecweLsSOql5w99en3%2bd2%2bdfePapc2NF5ojS8HEcK9LfA7LAbJAWKAGiFIuxQ/EiWh/Z37WJzknZVy7UMbD9No1Mz/T9cC7XWMl6gBP3jf2ulb7QoPuRFaPYHELFnh6RIu3aIXlk2x%2bqQfPk3l%2b%2buDyyuLqvbcvPvjtx7vvv/PZpx/t7rz7wsbFc6c3f7n1s92dd36z%2b8F7W9f4gX4iEnJ5SGdANCb%2b7gvXdxLD2LVrFGpfUMHBXXc91pgdwObuwP4fenLbqpcgDcYAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="1280" data-src="/assets/static/auto-checkin-covid19.a209973.c87091a851f8ca767e5cbc6ea41ac4d9.png" data-srcset="/assets/static/auto-checkin-covid19.a67b0b2.c87091a851f8ca767e5cbc6ea41ac4d9.png 480w, /assets/static/auto-checkin-covid19.a209973.c87091a851f8ca767e5cbc6ea41ac4d9.png 1280w" data-sizes="(max-width: 1280px) 100vw, 1280px" class="g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/auto-checkin-covid19.a209973.c87091a851f8ca767e5cbc6ea41ac4d9.png" class="g-image g-image--loaded" width="1280" alt="Cover image"></noscript></div><!----><div class="post__content"><p>最近这几天又不知道干点啥，天天上课累死了，前面的还没掌握就又要接新的知识，真是太难了。心血来潮想好好学一下 JavaScript 什么的前端基础，找资料逛博客的时候碰巧发现了一个学长的博客，看到《<a href="https://zjw1.top/2020/03/10/auto_checkin_during_covid19_and_cas_sso_learning/" target="_blank" rel="nofollow noopener noreferrer">疫情期间自动健康打卡暨 CAS 单点登录认证实践 - SiteForZJW</a>》这篇文章，常年起不来床的我赶紧点开了，啊啊啊我为什么没有早点发现这种好东西啊，生气。</p>
<p>第一次看的时候了解到这个 Python 代码要自己先手动执行一边获取表单数据。Emmm，那是啥，好像不太了解呢，先 Mark 了！</p>
<h2 id="python-和依赖"><a href="#python-%E5%92%8C%E4%BE%9D%E8%B5%96" aria-hidden="true"><span class="icon icon-link"></span></a>Python 和依赖</h2>
<p>什么？你说这个年头还有人电脑上没装 Python？なんと！</p>
<p>Windows 系统直接上 Python 官网下载安装包，注意将 Python 安装目录添加到 PATH 环境变量，一并安装 pip。如果运行时显示缺少模块就 pip 安装一下。</p>
<pre class="language-bash line-numbers"><code class="language-bash">python <span class="token parameter variable">-m</span> pip <span class="token function">install</span> <span class="token parameter variable">--upgrade</span> pip
pip <span class="token function">install</span> requests lxml<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span></span></code></pre>
<h2 id="获取-form-data"><a href="#%E8%8E%B7%E5%8F%96-form-data" aria-hidden="true"><span class="icon icon-link"></span></a>获取 form Data</h2>
<p>今天早上起来的出奇的早（7 点半我就醒了），一想到学校的打卡十点前就要完成，我突然想到了那个自动打卡、表单数据的事情。于是我点开了浏览器开始尝试。</p>
<p>打开 <a href="http://one.hrbeu.edu.cn/infoplus/form/JKXXSB/start" target="_blank" rel="nofollow noopener noreferrer">网上办事中心 - 平安行动</a> ，虽然不知道是啥，但 F12 肯定会告诉我的。选择 Network 栏，网页从打开这个菜单后加载的所有请求都会在这里显示，先刷新一遍网页，找了一遍好像什么也没有（一开始我以为表单数据是缓存下来的什么东西），Emmm，提交一遍试试，点完确认提交之后 Network 最下面显示了一个新的名叫 <code>doAction</code> 资源，那一定就是你了！<strong>注意此时不要点确定，点确定之后该资源会被刷新掉。</strong></p>
<p>好的，<code>Form Data</code> Get√ 。选择 <code>view parsed</code> <code>view decoded</code> 就能看到这个表单的所有数据，也就是之前 Python 自动打卡需要自定义的。完整存好 <code>formData</code> <code>boundFields</code> 的内容。</p>
<p><figure><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1901 1000' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-b614ee0887ec85536d75e1e090ff7ac9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-b614ee0887ec85536d75e1e090ff7ac9)' width='1901' height='1000' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAIAAABgN0jYAAAACXBIWXMAAAsSAAALEgHS3X78AAAK70lEQVRYw6WZSXYbuRmAeZ3cLDfINjlBbpBN1v2y6SyyS%2bclrx2727baMiXKokSyyJrJmlFzVT7gJ8vU1O2n/IYhAIVC/fMAztI0LQ34vp9lGQN6P/DzokjiOAxDzw%2bCIAyDINaQTFDX9TiOQ9/neRZFUdu2evoN0Pf9M6vj2Js2nB1SqKKpmht/ecijNz%2b%2bORgwaMSgXRRFnucz0OUPE3CdVkGIPo5iqGJ3FMX7MBT09f80pVNKVVVVVhU7mUI50/oF4JHK81Lxr5Rdsl%2bfUJZ121a23S1uhtvb%2bu5erxhIUv0VN/KTLFmtVqAnBEgPqnx3VtYNpzR13TYNvW5NAzv5S88mz3N93zsYHkMYp3OoYOC6LociIE40O72nqHNabmDn2ksn8uIi9BzX87ScfR%2bugYTjOOnbd9vF8n65yd7%2b7N7ducHZoySFfRweGibyIYiRp5wwU0mUZekhS/mj%2bzSNTmB4H%2b2BMARFxocTyIZpUTZP68fXzTPZgNzyjx%2b3y9tby1n5iWPvQMi2bVgAKpzufrxY/PDm6l/v/J8/WKsVTPE9nw3b7RaMYRY9jBO5lYaDHHtxcTG7DIrV0mqWy3q1Lpd3uWXlRYlO6VboVohWZfkDMHonQ9n39VFx9mKhzEArW7rZxPt9VhRZ1SqDDQ9gDjRAjGXvoGq7WTuet7PtwNeWxzoSEMZPfAkNMID9PJ397rvgT3/5T7a6/u/i4%2bZuoX58yzfyLDvDU%2bVlmaPrrCszliljVeinelAe14sTVQa5rWUhAmQNAegZK2hOqo0oNaaUwuP1em1ZFtjsD4ftdhcGoTwSUYfafQQiXl6nF8XbG0A/Z398n/7tHxf9zWd/MU%2bv5/Wny7SslBGXbgysrbq6VpeXKgjUxlK3S3XzRc3nyrGVZSnH1Yv3K724WKj9QWWFvAsVYaStUEg6nAEYi%2bWABOjCaTZ0BrA0qIXO1oAsMmVRntKLcI2h1jO81i6q5qvDxsnWTrIKy6Tqy6ZXx9aptFDBQbmBypSKUnVI1D5WXqjXaSzGmV5kj79XRaXqTt4t2z4oWtxibTwVHx4N4B/BBmc6nsC4j3qashOyjWs9AlNx0wLiu2Q86/oeAi638W2Q3Qb5Fy/Lqw4CqnaoWk1J2Y3lMLK9GcZqGItuVL2elt1wbEx7s2cwi00vrWr6MKsH8z0wEPc/0TARcI7oOTxaf2k642%2b0T8LtbrfdblYr%2boyPg6gqq1oPun7oup6Wppn2AW1fN8z51%2btH0psNuumVYwPhSLUTAY9iGWw%2bRbDxPMAJWr0BGeheH/Zgp7yuCWDNjbP1dovFoo7Iumq1rNHi5kysQJamOlwYksZvg6Q8EoDKovdoPJRI6KRnEWeywTvFMe4Sw2WVqeO6bMNSsVd24mpwqffLJSdoH3AG%2bIAZdIRRjmUnOfpcZkWZVl3dDXy57QcGU%2btAfRjzWut30z149Gxjz774KgGw53siCmEwA/DDgrEBesll8P9QB4N5ixW8aRln74Lbv2%2bskWBrLFtCrZg7KjQc9uluvblfrTcby7YdDJeMpNH2ruU2NYIqK6DVQsfZ%2bkuNPfGZCh20l9zCzsnBT%2bEPC2ZqWRvmt24aJqprdfwG/8RkL1GRbbOsa5rqlJhImIcLWoWCVG22W9/zcNtaT4yGwIbqZOkCfAm96l6lQpMEQFSw3%2b12koBABvxmBeXB/185mZ/wXYRTQKqoHBkJR3UnmNwrMtQEeHG%2bsZ2Ntb27X/vhHk8Ciq1p50YpUyy8brX8u99qj4wYAohZ4E3opdea7fvoMevwkpW7uzsyj8%2b7xInyvmuJZuxEDsQ8PEpU6DytfioBiIgOWegFLpINQuIhoV7jqjX%2bSIY0%2bE5T2sP2Xf/g0bONPYeHKiTYIwF6o96BZL5wFHqQD9Z9lMDQaxUyEoBI8LXzpjyp/mQDRgKjNuLtBheqQUut1iEDMs9jh/ZCRMcG7r9ShfAquxNgDKJOnAlhIMQiLgi8iEhuXKAmqBOk8iJpEC79Jqq7dtDR10S9xoCxgXFwD%2blqs1mv6DZkGWXTSvCrH7pR/YH6NQTUJnAKAZIPa4%2bJvybDM9k4qIht4GDndhIkahw6Qo6k0OiYTgqr%2bvvgYl8WPc7nAQHD4McYseP6QZzmeKCs6rSr6Uesuem%2btta40aLWUbbtHjx6trXajTbiD1KTpYOl5JW4FhhPLxKAr%2bBK2o2uz3fpfZDbUSFCk/pLVylt8/Zg40gHbBhFmFQIj4cN7F3P1Rm4Dxm5DlamxsNhnzXjGEcMoNHudeh/q2nrUo3RvVTcJZEIIaM/lgEsQeoNRM0i/rKsmis7uXHT%2bS7Bx7qOg%2bgQka57qzrKa1KtWNVxcazmjirkHdLl3d1yufxyc8MHdBzQbMsfqRAYoAqviMSiQvAbFaKf/KAEMghgyuE6eDXtjYMEirsgPwYyeIovUgWn/RjNf3/z1z98TP88L%2bHQZMSj5R3watQX%2byAgnSeIsigyOsdGdE7cyyuMGGaLBCR5lvobesCPDdi0mMfO8Q5JRoEB2UEQIhnZX9UVuv%2bd9%2bYqpixVVh4Q7U8S2CNinCf5Y6eqNlEtSoQYdL7Qfm1YBS2velX3Tfvg0bONPfv8AQHgKpVAaGpcAAIYwynXALZ969EyzEBKcMxGS94UA5Itjv3ol4fvg/dhlZ1sIMoIY9RF641l2U5hVEi/0Pei99LMQt8YHz%2berb/UgPhMAkms8zY4LeWYVAjihdBVaMK9w/drO1362cIheCnfeCFA9PkYxTDoSucUH%2bJ122kJjPY%2bvb1fWZgRbu76uix0BqHtRqlzfeCgV6cSYOP4e4kAkgVBg9x6MAYtpKGvO6oaI1646bW%2bi0gxAB7JBYTEL4HK3KFUta6ZdD1woJLa7drddvx8OSwWVdX8Ck4mSL/GBnZuKEkENIC0aIUYsSRzWDoEzO104WZXtibAM%2baBiB4RUBsCMIuyk1QiyqsoJdcEdSwhqztKlvL2Xl3dVMFe58akIQ0hsMP/FmVTVhSjenrspbX9o9a0/T5vhlMFSBFSnYCpVJhTaQJOUqyYdH0oGr0ublCQfqZkMzd5s6HvDmVHzmKS%2bFF/m1y6KJOfPux%2b%2blD/89/1/bp%2bf1FfzmtrV3%2b%2bqq9v6l8%2b1x9/qT/N6/l1fXNbf/pcOx5v/Xo9UD0EuSArT3C8vSP8m1u2XntasvdO0p7mZZjhlIu6i4qGAJGUTWparur0l3n0/iK9t0gD4ziPU1276zYNkkKPiypOizivdHx52CIOKTVf9bWUKnAmGPHO5O34IhSJKUq1PYEoGCmSFGLnUDwHysAsSvI4Saoi4itJmodRhhf2oxQ34MRFQswrz0B4pnthnjqulOqlJgm9fEwHLFQ7y1mW257GcFjb5ROZnAvqKcjVC/YzC%2bLG38dj45E/BWn5xc2CrCKS/3y/f7cMg7QypfT4/4DUxOQFO9v59GX9ZaVjkySkJNdIAwuW3G7ylZJiyMXRU97jISHecdzFYjHDPZt5pu%2bsKR2yhAm9ytOSWiKOOUJqP4FpLJfsMpju/aZ70nMwV8JKXxJ7rr3bOvZufwKTouJYbXNR1UyZFJizHzp523idampMiwLfRcnvkf/PzDVeSr4lBX9iIgu8oZiAPeTslFFTKcgjvoqOSg0uK1KjsGe6ypRLhwn0jwlV9Q1yPC%2bovxVmjy4qBJInIJzmkVibCPH4i8H5zx4Gzo%2bShJl%2bupB6ekX19G7r7HePF2gdjnv%2bBzaCWi%2bQr5yGAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="1901" alt="Network" data-srcset="/assets/static/heu-checkin1.82a2fbd.2e35e2c967dd8ae72bbd6d3ad3bee786.png 480w, /assets/static/heu-checkin1.cbab2cf.2e35e2c967dd8ae72bbd6d3ad3bee786.png 1024w, /assets/static/heu-checkin1.eaff22a.2e35e2c967dd8ae72bbd6d3ad3bee786.png 1901w" data-sizes="(max-width: 1901px) 100vw, 1901px" data-src="/assets/static/heu-checkin1.eaff22a.2e35e2c967dd8ae72bbd6d3ad3bee786.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/heu-checkin1.eaff22a.2e35e2c967dd8ae72bbd6d3ad3bee786.png" width="1901" alt="Network"></noscript><figcaption>Network</figcaption></figure><figure><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1901 1000' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-0de6a417156f0b67252112b29abcd96b'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-0de6a417156f0b67252112b29abcd96b)' width='1901' height='1000' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAIAAABgN0jYAAAACXBIWXMAAAsSAAALEgHS3X78AAAM8UlEQVRYw7VYV3fbyBXmr8pz/kZe8ivyZFuyZKqwNzSCdFzkLiWbbPZ4rbU3Ttl4Ja3tldWLxQ4SBNgAkiBBgqLyzQxFU267zjm5uh4PLmaIe%2bf2cTWbzQ6FSqXSarW63S5GOm83TaNarWp6BWO1UjVN0zAMjM0mBtO27eFwOBgM2u12o9Ho9/t4PP0l%2bBVL3oFlWT27d6Kn663G%2bto6vl6v1/EtykPTouACu2wGJhkVFKxrUbY0Ta/Xsa2Bt2ynYZARAJl7vR7EgAB4hOSY9z4BeNO1rG6XrhpRbLZ%2bPA76/dOBw970KbDDVetlo2Vk0hkwBh4gBhsZqy671%2b/Sn8SG8ffYvO84VqdTLpc1TYNIIGJk0uIb%2bOlSqYRvVKpERRADKyk3I2ScYVebQrFcSqkNzbCqmlrWdHxb13VshFJLJRULlHItU9TaVkcrE8ArnIuqlltmixiCpsEuwDq%2bns1m2Vv8gguG0iY2AU6oZZjNMTZbLRCxp1FvGA0YT9MwqBEZbNnIotgugGFc3H7%2bg/S8zPbWlpJKpZVyTjfVUlHTdcgPtqrVGrjRde1tXjvM4bFeyOd1CligKMU2ZOp0ICFYxwRKZCdYq9W2t7ddR4XyUa5YhqT4U9XSp6BYPJ/QOcMRqASL9NUk4NdUtVgs4kv4XjObaVQqZqttdnrtdosZAFjHKpx3oVBQi0qxkFPpFhx2tVKBKvBQr9cMdnJ0xBYYAiaQsFhUXL%2bZuvXbP4QFWZgO%2b/xCTI7HRYBEkYEkibIsJhIiXjHEI3D8OEnEYrpXikscFwuFgqFQ6LvV7%2bCRcCZogoQLsN4m3ONMYZ75PJhXdL2C9wVFgUKgYcNs1qE606w2DOp%2bxH2xAIiVRLxqDc%2bOc%2bb6vf/W7y4HJZHzhQOhaETguRjHx2I8x1GMcZzPx127xl29ygUCnMfDzc1zbjc3M0PoHi/n9xPi4iIhYlkoRLbQvbEYFwxHQ8Hg6uoqnMGsN6iGobo3hfzLamW3qu9W9J1adR/Y6WTtbs62c3Y3a9v5jvnWLm93q/u2umW10x0rY1npdivV7WTZI9Du5rvtddc3X60EIpw7JPqikjcqAqNCnJdkXopTlHkIFAjxvgDP8XwkyocjfCjMB4J8lCMYAzFG6MEQIfICL7LtshCXoVlQ/v79951up2Y3ETB6tlWrHmm6iojSbhtATJrNOhABvNtpkjDebZqFbPXJt9nnz5tPv6vVdaMBJejlsoJlcI16TW82q4iCfeuOa3l5eSEQnfFG5oIxdyDm9kdjgiSIcUGKC6JMJnFZkBNCIililBN8PMGTSZLQJ5ERJbrlHMO8BKmfPXvWd/rtfuf0DDBoNQtFhCTiI2XqRypMCIHJcU4RP3s9B46KmJHbP6zlFMdsOgOSP84uAvLJcHg27P/NtbKy4vcHQ16v1%2bdbXFz0eb1EACnO4SwF/B%2bXpBFGcd4Awpk0Jn4E4yMERPg4bIkI0O8j5dEP900jVyyq8E8qAzErxCJEK8dxWNi1rDZimFavVUyzXKupGmKrdfY%2b0NNwvoYAy55gxOPzxaIRADwPDijLsgBbEIRkMpFIyAyj0Ygo4qzluBwfEz%2bDyYQcE98JkM/nNRL%2bkYeyxRJyS1lRFBARcyAEYi4TAKedzedLBwfFV6/L2zulV68r%2bQJi1sB5D3rw4IH9ZyKALxgOhsI4X5x6DChIOGZIIQKl%2bBglOQEiR99O0j%2bDEZjQuQA06uGwi7VqqqRq4BgRvT0BLHueDgYZpZB9%2biz3/fPc2lp%2b9bvq3r5pWQbNJhOASNppm/dHJuT3eBZgQIvQhA%2b%2bC9YlArACeYw0ohLrEi/SL6D8DgGIB0wAnBiiIbISHLFaOVFVEuIRDTUKbAJ5sAwFVSabRc1wZveGnc7Q6qDeGp6dfc6EfKEoPCAQCHi8nlgsKlFWOBIM%2bUQyObaJcDgMFyB6AGsfM5oEyBOYlOXYRQGIs6oFCMB8gGUlJHpkOigEGkC%2bgwml02lkibNfgAkBvCH4AHTgnV9YROIhIYX6Y0IUExjHKJIRaSouShfoFIm1TXjwuRNLYwGQd6CBUqlQq6XLZVIF4cgHE4A1kAECZDKZLxJgxR8II4kFggQhAAdL4YWV6Zkl9/ztmWu3Z90jvDa3dG3uxoz75oz7HZHirVn33WtzD6dnPyMA04Bpoi7IQYBU6gQZGI6BOgJOzEpGxCJw9T8IEPJ7vcQFFhZCwQB8IMkLd2fdN%2b/effTw4QOGDx7cu0/gHsUHF%2bHhw4e3bt26755PxJnxE0hcNCFoAE6s66pRz4Bb/LESDUDLCwLQCXzgS01oxRMIL0IA6sXhYJAIIIg3pqaPUynotUm7nFFR/7GKH4aLn1pfX7s5fTUpy58RAGWPomTLWiqbQwBFNihCA%2bAVZsNCI%2buKvlQDy16SB/z%2bQDAcQeAmwTse429enc0oikN7AMbipwCfpAKsJy9PydKFyItMjFLiyZMnOAK4rFIstpqNulFAHkASgAmxH%2b%2bfA8sDX6aB5ZWVQCAcIQ4QDASCGDkR1YJ4%2b%2bpsVlHG/H3yZ4bDhtXDZGNj44%2bXp5PxxDikIpRG%2bTjS%2bbePH8M8mAkVChlNPUAFncsSYH3SuJcifdlgAAFgV19kQiEYz/z8vNvt9ngWmQn98fKVVCZD1vSd4eAUreyHeHZ6ihIhp7cg4k/razeuTF0nhvNxE0L5C1%2bFCRlmXtOrhaKSpU7MehTwjbNn5caXmdCfVlYW/UEUQlwshvNH9EfRluCFpVl38s6dew8e3Ll/n%2bESHW/fu7d07/6YeBcO/fDBvYcPkjdu3p2bT37aiVFCIAop%2bYy29UPqx43Uv39Ira2l0um3FBCIyM1BpYKckM5kINOvEWDYpxrw%2bsOwfqRYXkQdKkVRrnHCyqWpG9Mz1y9duX55ahLlS1cSly5QkpcI3p6aWb48TWrYCQy/KyWcXFFHHlBgQj%2buHn/z5PirvxZfrBWKaiEPZ4A/l3K5PLCQL6CRY6r4ZQ0M/kIEgA9ABahHPUCUEsgDOEdRTIridUkaIxIZKHBSTCbpDJPIZZIkfyIK9ZEHarSh0dRG6ofKv76u1naM%2bn61sqNrW/Xabr22V6/u1qo7qrZTUrea7fTAyfd7uYFTGPTzTj9/eqoML2DhbKhb5qORD8yTOsgT9noj12YFjo/LCVgUSgk5CbdMMCQ5DtW0nEDrOCZOonwRLphQv1/RNWSsAjLWxnqnWHDOhk6/h%2b6yUa/1el209QOnB2fYV%2bpHqoER5Roq7narWdHLdbrGtjtA9PTdbsfuWkbX3j84pInMF0B/KHq9yenp6263iE4kfl7gjKqeBGMPxTUt5EaUcRE0WvmpWujpU2cwQDFJ%2bn6EzzdvUFK0WlaP3LhY6G8dZ4BmF9HC7jlvy61MxTout9C%2bgVir1YHw88FwSDLFYABl9h1SdzT7zvHh8SiMimHU%2bhJpYUQJDQGqiQvWLL6bcAJ1lXevJIrx96x/wge4Z8%2bfo5iurW8oGxuF/7xQ19a115uljQ39501zd097%2bdp%2be6L8uN4%2bOLSO3m6/2D7a2N39cdvY2Suubxg7u%2bWXr%2bo/b9qFQo82DOwGDXG31u1uHu67VpaXA1EUmQmBdrFkpDkITu2bXxDnFgT3nHBlSpieETxe4eqsMOsWrs4Il6fIOHONvJ2%2bKnh9dO%2bHAsTR4z/75z97ubzx93%2bU19bL/3nR3d2zd/fZ2H6zBcG6O3v1n17Zu3ud7d3Mi83c2mZh7Y29d2BtbTd%2bemW%2b/tne2u4dHFKrG8GpMzB77RO96Fp%2b9CgS49D7RXgxyosxNgoSMBrj0UaiX49EYhEyGSMoHEE2x4i2nhc/RPwINPD06VN8slYuF1IpNZslFymptJJK59%2beaAhA6Uz%2b5ARjKZtV0mk9n0eSa1eryHxWvdFpGFajYZ3fCI6hTS%2b5%2bnbPdefuvVAoJPJRgeejsVgoEo3GuGAk6g9F/WHwzwnEsAQ6ok2mKEwgP0H/ANGUootYXV11SKdrwXbrZstsWTCCaq3WME1q0ATsCSftdO3u%2bQUliOw6rkM5HgOsqNVu6RXddfPuo0V/4LoURGgJRfm5ABeKCbO%2b6KWF8KX5cDCGtjgpj/IrHd%2bPNufEj7Y4ySREZy0luRNSy3sn%2bZMsajitSC8kUEJjgsiE2mFUMlJgXQ69zHr/7AH0GtPA3uPjY9edO0uhUBCnjo4%2bFo3y%2bBeNYBS4GBBPEQrRc/jwcUz8EPDK7/c/fvwYZ8yKfmQytUQuGxkg9SoUiH5oKcoAfLMOAWvGV9njC21ICzrKEKRw19LSEr4RiYQZhNDb%2bEl3BiL6Y2S3hfl5D57JtQtKVn8wGGSvJsFPtnjYerSm4XOADKBAAHbff/Z/ABcqp4ODg8NPw%2bTbo6Ojly9fbm5uYnL4qwGfwJkNJ%2bC9avzDgvejKz%2b65r%2bQKjzVgMzXLAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="1901" alt="doAction - Form Data" data-srcset="/assets/static/heu-checkin2.82a2fbd.a282637541e4f36d4a8e50f3a438dbec.png 480w, /assets/static/heu-checkin2.cbab2cf.a282637541e4f36d4a8e50f3a438dbec.png 1024w, /assets/static/heu-checkin2.eaff22a.a282637541e4f36d4a8e50f3a438dbec.png 1901w" data-sizes="(max-width: 1901px) 100vw, 1901px" data-src="/assets/static/heu-checkin2.eaff22a.a282637541e4f36d4a8e50f3a438dbec.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/heu-checkin2.eaff22a.a282637541e4f36d4a8e50f3a438dbec.png" width="1901" alt="doAction - Form Data"></noscript><figcaption>doAction - Form Data</figcaption></figure></p>
<h2 id="调试"><a href="#%E8%B0%83%E8%AF%95" aria-hidden="true"><span class="icon icon-link"></span></a>调试</h2>
<p>表单数据有了，开始调试 Python 。</p>
<h3 id="邮件提醒"><a href="#%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92" aria-hidden="true"><span class="icon icon-link"></span></a>邮件提醒</h3>
<p>源代码最后的发送邮件部分需要自行引用发送邮件的 <code>.py</code> 文件，但是谷歌找到的好几个 <code>sendmail.py</code> 补上去之后都有奇怪的报错，比如 <code>if</code> 条件右括号报语法错误，我明明是直接复制的啊 QaQ ，看了好几遍也不应该有错啊（后来发觉可能是 Python 版本问题）。最终我索性直接搜 Python SMTP 的用法，找了一段代码补上去。</p>
<p>在 Linux 下试运行的时候发现打卡段没问题，但是后面邮件发送这段报错：</p>
<pre class="language-powershell line-numbers"><code class="language-powershell">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"checkin.py"</span><span class="token punctuation">,</span> line 151<span class="token punctuation">,</span> in &lt;module>
    smtpObj<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>mail_host<span class="token punctuation">,</span> 25<span class="token punctuation">)</span>    <span class="token comment"># 25 为 SMTP 端口号</span>
  File <span class="token string">"/usr/lib64/python3.6/smtplib.py"</span><span class="token punctuation">,</span> line 336<span class="token punctuation">,</span> in connect
    self<span class="token punctuation">.</span>sock = self<span class="token punctuation">.</span>_get_socket<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> self<span class="token punctuation">.</span>timeout<span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib64/python3.6/smtplib.py"</span><span class="token punctuation">,</span> line 307<span class="token punctuation">,</span> in _get_socket
    self<span class="token punctuation">.</span>source_address<span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib64/python3.6/socket.py"</span><span class="token punctuation">,</span> line 724<span class="token punctuation">,</span> in create_connection
    raise err
  File <span class="token string">"/usr/lib64/python3.6/socket.py"</span><span class="token punctuation">,</span> line 713<span class="token punctuation">,</span> in create_connection
    sock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>sa<span class="token punctuation">)</span>
TimeoutError: <span class="token namespace">[Errno 110]</span> Connection timed out<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>搜索了一圈发现 Linux 下 SMTP 发信加密程度要求更高，所以得加密发信，将原来的发信替换为 SSL 加密发信：</p>
<pre class="language-python line-numbers"><code class="language-python">smtpObj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token punctuation">)</span> 
smtpObj<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>mail_host<span class="token punctuation">,</span> <span class="token number">465</span><span class="token punctuation">)</span>      <span class="token comment"># 一般加密发信 smtp 端口号为 465</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span></span></code></pre>
<p>在 3.7 版本以上的 Python 中需要此脚本时必须使用 <code>smtpObj = smtplib.SMTP_SSL(mail_host)</code> ，否则邮件发信会报错 ValueError 如下：</p>
<pre class="language-powershell line-numbers"><code class="language-powershell">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"/home/Project/Python/HEUCheckin-2018041015.py"</span><span class="token punctuation">,</span> line 170<span class="token punctuation">,</span> in &lt;module>
    smtpObj<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>mail_host<span class="token punctuation">,</span> 465<span class="token punctuation">)</span>       <span class="token comment"># 加密时 SMTP 端口号为 465</span>
  File <span class="token string">"/usr/local/Python3.8.2/lib/python3.8/smtplib.py"</span><span class="token punctuation">,</span> line 339<span class="token punctuation">,</span> in connect
    self<span class="token punctuation">.</span>sock = self<span class="token punctuation">.</span>_get_socket<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> self<span class="token punctuation">.</span>timeout<span class="token punctuation">)</span>
  File <span class="token string">"/usr/local/Python3.8.2/lib/python3.8/smtplib.py"</span><span class="token punctuation">,</span> line 1042<span class="token punctuation">,</span> in _get_socket
    new_socket = self<span class="token punctuation">.</span>context<span class="token punctuation">.</span>wrap_socket<span class="token punctuation">(</span>new_socket<span class="token punctuation">,</span>
  File <span class="token string">"/usr/local/Python3.8.2/lib/python3.8/ssl.py"</span><span class="token punctuation">,</span> line 500<span class="token punctuation">,</span> in wrap_socket
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>sslsocket_class<span class="token punctuation">.</span>_create<span class="token punctuation">(</span>
  File <span class="token string">"/usr/local/Python3.8.2/lib/python3.8/ssl.py"</span><span class="token punctuation">,</span> line 1031<span class="token punctuation">,</span> in _create
    self<span class="token punctuation">.</span>_sslobj = self<span class="token punctuation">.</span>_context<span class="token punctuation">.</span>_wrap_socket<span class="token punctuation">(</span>
ValueError: server_hostname cannot be an empty string or <span class="token function">start</span> with a leading dot<span class="token punctuation">.</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="关闭代理"><a href="#%E5%85%B3%E9%97%AD%E4%BB%A3%E7%90%86" aria-hidden="true"><span class="icon icon-link"></span></a>关闭代理</h3>
<p>本地调试的时候，由于我平时习惯开 Clash 代理挂着，没注意这个，结果就报错了，信息如下：</p>
<details><summary><strong>Python Traceback</strong></summary><br />
<pre class="language-powershell line-numbers"><code class="language-powershell">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\urllib3\connectionpool.py"</span><span class="token punctuation">,</span> line 665<span class="token punctuation">,</span> in urlopen
    httplib_response = self<span class="token punctuation">.</span>_make_request<span class="token punctuation">(</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\urllib3\connectionpool.py"</span><span class="token punctuation">,</span> line 421<span class="token punctuation">,</span> in _make_request
    six<span class="token punctuation">.</span>raise_from<span class="token punctuation">(</span>e<span class="token punctuation">,</span> None<span class="token punctuation">)</span>
  File <span class="token string">"&lt;string>"</span><span class="token punctuation">,</span> line 3<span class="token punctuation">,</span> in raise_from
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\urllib3\connectionpool.py"</span><span class="token punctuation">,</span> line 416<span class="token punctuation">,</span> in _make_request
    httplib_response = conn<span class="token punctuation">.</span>getresponse<span class="token punctuation">(</span><span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\http\client.py"</span><span class="token punctuation">,</span> line 1322<span class="token punctuation">,</span> in getresponse
    response<span class="token punctuation">.</span><span class="token keyword">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\http\client.py"</span><span class="token punctuation">,</span> line 303<span class="token punctuation">,</span> in <span class="token keyword">begin</span>
    version<span class="token punctuation">,</span> status<span class="token punctuation">,</span> reason = self<span class="token punctuation">.</span>_read_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\http\client.py"</span><span class="token punctuation">,</span> line 272<span class="token punctuation">,</span> in _read_status
    raise RemoteDisconnected<span class="token punctuation">(</span><span class="token string">"Remote end closed connection without"</span>
http<span class="token punctuation">.</span>client<span class="token punctuation">.</span>RemoteDisconnected: Remote <span class="token keyword">end</span> closed connection without response

During handling of the above exception<span class="token punctuation">,</span> another exception occurred:

Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\adapters.py"</span><span class="token punctuation">,</span> line 439<span class="token punctuation">,</span> in send
    resp = conn<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\urllib3\connectionpool.py"</span><span class="token punctuation">,</span> line 719<span class="token punctuation">,</span> in urlopen
    retries = retries<span class="token punctuation">.</span>increment<span class="token punctuation">(</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\urllib3\util\retry.py"</span><span class="token punctuation">,</span> line 436<span class="token punctuation">,</span> in increment
    raise MaxRetryError<span class="token punctuation">(</span>_pool<span class="token punctuation">,</span> url<span class="token punctuation">,</span> error or ResponseError<span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">)</span>
urllib3<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>MaxRetryError: HTTPConnectionPool<span class="token punctuation">(</span>host=<span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port=7890<span class="token punctuation">)</span>: Max retries exceeded with url: http:<span class="token operator">/</span><span class="token operator">/</span>cas<span class="token punctuation">.</span>hrbeu<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn/cas/login?service=http%3A%2F%2Fjkgc<span class="token punctuation">.</span>hrbeu<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn%2Finfoplus%2Flogin%3FretUrl%3Dhttp%253A%252F%252Fjkgc<span class="token punctuation">.</span>hrbeu<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn%252Finfoplus%252Fform%252FJSXNYQSBtest%252Fstart%253Fticket%253DST-3779417-6SDr7iRPSkJxSd3MFyNd-cas01<span class="token punctuation">.</span>example<span class="token punctuation">.</span>org <span class="token punctuation">(</span>Caused by ProxyError<span class="token punctuation">(</span><span class="token string">'Cannot connect to proxy.'</span><span class="token punctuation">,</span> RemoteDisconnected<span class="token punctuation">(</span><span class="token string">'Remote end closed connection without response'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

During handling of the above exception<span class="token punctuation">,</span> another exception occurred:

Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"d:/workshop/PythonProject/CheckIn/checkin.py"</span><span class="token punctuation">,</span> line 61<span class="token punctuation">,</span> in &lt;module>
    response302 = sesh<span class="token punctuation">.</span>post<span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token keyword">data</span>=user_form<span class="token punctuation">,</span> headers=headers<span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\sessions.py"</span><span class="token punctuation">,</span> line 578<span class="token punctuation">,</span> in post
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token keyword">data</span>=<span class="token keyword">data</span><span class="token punctuation">,</span> json=json<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\sessions.py"</span><span class="token punctuation">,</span> line 530<span class="token punctuation">,</span> in request
    resp = self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>prep<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>send_kwargs<span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\sessions.py"</span><span class="token punctuation">,</span> line 665<span class="token punctuation">,</span> in send
    history = <span class="token namespace">[resp for resp in gen]</span> <span class="token keyword">if</span> allow_redirects <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\sessions.py"</span><span class="token punctuation">,</span> line 665<span class="token punctuation">,</span> in &lt;listcomp>
    history = <span class="token namespace">[resp for resp in gen]</span> <span class="token keyword">if</span> allow_redirects <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\sessions.py"</span><span class="token punctuation">,</span> line 237<span class="token punctuation">,</span> in resolve_redirects
    resp = self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\sessions.py"</span><span class="token punctuation">,</span> line 643<span class="token punctuation">,</span> in send
    r = adapter<span class="token punctuation">.</span>send<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>
  File <span class="token string">"D:\Python\Python38-64\lib\site-packages\requests\adapters.py"</span><span class="token punctuation">,</span> line 510<span class="token punctuation">,</span> in send
    raise ProxyError<span class="token punctuation">(</span>e<span class="token punctuation">,</span> request=request<span class="token punctuation">)</span>
requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>ProxyError: HTTPConnectionPool<span class="token punctuation">(</span>host=<span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port=7890<span class="token punctuation">)</span>: Max retries exceeded with url: http:<span class="token operator">/</span><span class="token operator">/</span>cas<span class="token punctuation">.</span>hrbeu<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn/cas/login?service=http%3A%2F%2Fjkgc<span class="token punctuation">.</span>hrbeu<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn%2Finfoplus%2Flogin%3FretUrl%3Dhttp%253A%252F%252Fjkgc<span class="token punctuation">.</span>hrbeu<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn%252Finfoplus%252Fform%252FJSXNYQSBtest%252Fstart%253Fticket%253DST-3779417-6SDr7iRPSkJxSd3MFyNd-cas01<span class="token punctuation">.</span>example<span class="token punctuation">.</span>org <span class="token punctuation">(</span>Caused by ProxyError<span class="token punctuation">(</span><span class="token string">'Cannot connect to proxy.'</span><span class="token punctuation">,</span> RemoteDisconnected<span class="token punctuation">(</span><span class="token string">'Remote end closed connection without response'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</details><br />
<p>报错一大堆没怎么看懂，<code>ProxyError</code> 看来应该是代理问题，可能和主机的网络设置有关系，没有深究原因，所以解决方案就是 <strong>关掉代理</strong> ！</p>
<blockquote>
<p>尝试了在运行前用 <code>export</code> 或者 <code>set</code> 命令设置 <code>http_proxy</code> <code>https_proxy</code> 代理，也一样无法使用。</p>
</blockquote>
<h3 id="结果判定"><a href="#%E7%BB%93%E6%9E%9C%E5%88%A4%E5%AE%9A" aria-hidden="true"><span class="icon icon-link"></span></a>结果判定</h3>
<p>调试时还发现个问题，原代码打卡出错的判定有缺陷，只报 Python 脚本出 Exception 时的错，而提交表单时可能成功提交，但是返回的不是打卡成功，而是打卡失败。那么如何判断打卡提交正常但是打卡失败呢，这里关注返回的数据 <code>response_end</code> ，用 requests 库转换成 text 后的 <code>response_end.text</code> 缩进一下长这个样子：</p>
<pre class="language-json line-numbers"><code class="language-json"># 成功时
<span class="token punctuation">{</span>
  <span class="token property">"errno"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">"ecode"</span><span class="token operator">:</span><span class="token string">"SUCCEED"</span><span class="token punctuation">,</span>
  <span class="token property">"entities"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token property">"stepId"</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"办结"</span><span class="token punctuation">,</span>
    <span class="token property">"code"</span><span class="token operator">:</span><span class="token string">"autoStep1"</span><span class="token punctuation">,</span><span class="token property">"status"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"Auto"</span><span class="token punctuation">,</span><span class="token property">"flowStepId"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">"executorSelection"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">"timestamp"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">"posts"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"users"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"parallel"</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">"hasInstantNotification"</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">"hasCarbonCopy"</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">"entryId"</span><span class="token operator">:</span><span class="token number">2797847</span><span class="token punctuation">,</span><span class="token property">"entryStatus"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">"entryRelease"</span><span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

# 失败时
<span class="token punctuation">{</span>
  <span class="token property">"errno"</span><span class="token operator">:</span><span class="token number">22001</span><span class="token punctuation">,</span>
  <span class="token property">"ecode"</span><span class="token operator">:</span><span class="token string">"EVENT_CANCELLED"</span><span class="token punctuation">,</span>
  <span class="token property">"error"</span><span class="token operator">:</span><span class="token string">"发生异常\n\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.GeneratedMethodAccessor457.invoke(Unknown Source)\n\t...\n"</span><span class="token punctuation">,</span>
  <span class="token property">"entities"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以看到返回的字段中 <code>errno</code> 为 <code>0</code> 代表成功提交，剩下的 <code>ecode</code> 显示 <code>str</code> 型的状态，<code>error</code> 只有出现错误时才有，包含了所有的错误信息，这个错误是在学校服务器上报的，不是本地脚本的问题。<code>entities</code> 包含成功提交后的一些数据。那么这就用 <code>errno</code> 来判定远程提交后返回是否成功。先使用 <code>json.loads()</code> 将其转换为 JSON 格式，注意在返回的数据中 <code>errno</code> 字段为 <code>int</code> 类型，<code>entities</code> 字段为 <code>list</code> 类型，发信的 <code>msg</code> 要用 <code>str()</code> 转换这两个数据。</p>
<p>实现代码如下：</p>
<pre class="language-python line-numbers"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># ......</span>

    response_end <span class="token operator">=</span> sesh<span class="token punctuation">.</span>post<span class="token punctuation">(</span>submit_url<span class="token punctuation">,</span> data<span class="token operator">=</span>submit_form<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    resJson <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response_end<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form url: '</span><span class="token punctuation">,</span> form_response<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    <span class="token comment"># print('Form status: ', response_end.text)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form Status: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form stJson: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">)</span>
    <span class="token comment"># 获取表单返回 Json 数据所有 key 用这个</span>
    <span class="token comment"># print('Form stJsonkey: ', resJson.keys())</span>

    <span class="token comment"># 加入远程提交返回结果判断</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'errno'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form Succeed: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        title <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'打卡成功 &lt;</span><span class="token interpolation"><span class="token punctuation">{</span>submit_form<span class="token punctuation">[</span><span class="token string">"stepId"</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">>'</span></span>
        msg <span class="token operator">=</span> <span class="token string">'\t表单地址: '</span> <span class="token operator">+</span> form_response<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'\n\n\t表单状态: \n\t\terrno：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'errno'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tecode：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tentities：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'entities'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\n\n\t完整返回：'</span> <span class="token operator">+</span> response_end<span class="token punctuation">.</span>text
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form Error: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        title <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'打卡失败！校网出错'</span></span>
        msg <span class="token operator">=</span> <span class="token string">'\t表单地址: '</span> <span class="token operator">+</span> form_response<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'\n\n\t错误信息: \n\t\terrno：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'errno'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tecode：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tentities：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'entities'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\n\n\t完整返回：'</span> <span class="token operator">+</span> response_end<span class="token punctuation">.</span>text
<span class="token keyword">except</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n:.:.:.:.: Except return :.:.:.:.:'</span><span class="token punctuation">)</span>
    err <span class="token operator">=</span> traceback<span class="token punctuation">.</span>format_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Python Error: \n'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    title <span class="token operator">=</span> <span class="token string">'打卡失败！脚本出错'</span>
    msg <span class="token operator">=</span> <span class="token string">'\t脚本报错: \n\n\t'</span> <span class="token operator">+</span> err<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>好啦，现在就差不多完美了，唯一美中不足的就是没有加入 <code>retry</code> 的功能，还不了解这个怎么实现，有空可以试试。</p>
<h2 id="完工"><a href="#%E5%AE%8C%E5%B7%A5" aria-hidden="true"><span class="icon icon-link"></span></a>完工</h2>
<details><summary><strong>修补完整的 auto-checkin.py</strong></summary><br />
<pre class="language-python line-numbers"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token comment"># -*- coding: UTF-8 -*-</span>

<span class="token triple-quoted-string string">"""
平安行动自动打卡

Created on 2020-04-13 20:20
@author: ZhangJiawei &amp; Monst.x
"""</span>

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> lxml<span class="token punctuation">.</span>html
<span class="token keyword">import</span> re
<span class="token keyword">import</span> json
<span class="token keyword">import</span> random
<span class="token keyword">import</span> time
<span class="token keyword">import</span> smtplib
<span class="token keyword">import</span> traceback

headers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"</span><span class="token punctuation">,</span>
    <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate, br"</span><span class="token punctuation">,</span>
    <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN"</span><span class="token punctuation">,</span>
    <span class="token string">"Cache-Control"</span><span class="token punctuation">:</span> <span class="token string">"max-age=0"</span><span class="token punctuation">,</span>
    <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"keep-alive"</span><span class="token punctuation">,</span>
    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>
    <span class="token string">"Cookie"</span><span class="token punctuation">:</span> <span class="token string">"MESSAGE_TICKET=%7B%22times%22%3A0%7D; "</span><span class="token punctuation">,</span>
    <span class="token string">"Host"</span><span class="token punctuation">:</span> <span class="token string">"cas.hrbeu.edu.cn"</span><span class="token punctuation">,</span>
    <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"https://cas.hrbeu.edu.cn/cas/login?service=http%3A%2F%2Fjkgc.hrbeu.edu.cn%2Finfoplus%2Flogin%3FretUrl%3Dhttp%253A%252F%252Fjkgc.hrbeu.edu.cn%252Finfoplus%252Fform%252FJSXNYQSBtest%252Fstart"</span><span class="token punctuation">,</span>
    <span class="token string">"Upgrade-Insecure-Requests"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362"</span>
<span class="token punctuation">}</span>

data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string">"studentNumber"</span><span class="token punctuation">,</span>                <span class="token comment"># 学号</span>
    <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"password"</span>                      <span class="token comment"># 教务处密码</span>
<span class="token punctuation">}</span>
<span class="token keyword">def</span> <span class="token function">findStr</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> source<span class="token punctuation">.</span>find<span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span>
title <span class="token operator">=</span> <span class="token string">""</span>
msg <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment">#get</span>
    url_login <span class="token operator">=</span> <span class="token string">'https://cas.hrbeu.edu.cn/cas/login?service=http%3A%2F%2Fjkgc.hrbeu.edu.cn%2Finfoplus%2Fform%2FJSXNYQSBtest%2Fstart'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Begin to login ..."</span><span class="token punctuation">)</span>
    sesh <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    req <span class="token operator">=</span> sesh<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url_login<span class="token punctuation">)</span>
    html_content <span class="token operator">=</span> req<span class="token punctuation">.</span>text

    <span class="token comment">#post</span>
    login_html <span class="token operator">=</span> lxml<span class="token punctuation">.</span>html<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>html_content<span class="token punctuation">)</span>
    hidden_inputs<span class="token operator">=</span>login_html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">r'//div[@id="main"]//input[@type="hidden"]'</span><span class="token punctuation">)</span>
    user_form <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token punctuation">.</span>attrib<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> x<span class="token punctuation">.</span>attrib<span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> hidden_inputs<span class="token punctuation">}</span>

    user_form<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>
    user_form<span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>
    user_form<span class="token punctuation">[</span><span class="token string">"captcha"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">''</span>
    user_form<span class="token punctuation">[</span><span class="token string">"submit"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'登 录'</span>
    headers<span class="token punctuation">[</span><span class="token string">'Cookie'</span><span class="token punctuation">]</span> <span class="token operator">=</span> headers<span class="token punctuation">[</span><span class="token string">'Cookie'</span><span class="token punctuation">]</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Set-cookie'</span><span class="token punctuation">]</span>

    req<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://cas.hrbeu.edu.cn/cas/login;jsessionid=</span><span class="token interpolation"><span class="token punctuation">{</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"JSESSIONID"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">?service=http%3A%2F%2Fjkgc.hrbeu.edu.cn%2Finfoplus%2Fform%2FJSXNYQSBtest%2Fstart'</span></span>
    response302 <span class="token operator">=</span> sesh<span class="token punctuation">.</span>post<span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>user_form<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    casRes <span class="token operator">=</span> response302<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CAS response header"</span><span class="token punctuation">,</span> findStr<span class="token punctuation">(</span>casRes<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Set-Cookie'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'CASTGC'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">#get</span>
    jkgc_response <span class="token operator">=</span> sesh<span class="token punctuation">.</span>get<span class="token punctuation">(</span>response302<span class="token punctuation">.</span>url<span class="token punctuation">)</span>

    <span class="token comment">#post</span>
    headers<span class="token punctuation">[</span><span class="token string">'Accept'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'*/*'</span>
    headers<span class="token punctuation">[</span><span class="token string">'Cookie'</span><span class="token punctuation">]</span> <span class="token operator">=</span> jkgc_response<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Cookie'</span><span class="token punctuation">]</span>
    headers<span class="token punctuation">[</span><span class="token string">'Host'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'jkgc.hrbeu.edu.cn'</span>
    headers<span class="token punctuation">[</span><span class="token string">'Referer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> jkgc_response<span class="token punctuation">.</span>url
    jkgc_html <span class="token operator">=</span> lxml<span class="token punctuation">.</span>html<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>jkgc_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    csrfToken <span class="token operator">=</span> jkgc_html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">r'//meta[@itemscope="csrfToken"]'</span><span class="token punctuation">)</span>
    csrfToken <span class="token operator">=</span> csrfToken<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attrib<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>
    jkgc_form <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'idc'</span><span class="token punctuation">:</span> <span class="token string">'JSXNYQSBtest'</span><span class="token punctuation">,</span>
        <span class="token string">'release'</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token string">'csrfToken'</span><span class="token punctuation">:</span> csrfToken<span class="token punctuation">,</span>
        <span class="token string">'formData'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'_VAR_URL'</span><span class="token punctuation">:</span> jkgc_response<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
            <span class="token string">'_VAR_URL_Attr'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                <span class="token string">'ticket'</span><span class="token punctuation">:</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r'.*ticket=(.*)'</span><span class="token punctuation">,</span> jkgc_response<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    jkgc_form<span class="token punctuation">[</span><span class="token string">'formData'</span><span class="token punctuation">]</span> <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>jkgc_form<span class="token punctuation">[</span><span class="token string">'formData'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    jkgc_url <span class="token operator">=</span> <span class="token string">'http://jkgc.hrbeu.edu.cn/infoplus/interface/start'</span>
    response3 <span class="token operator">=</span> sesh<span class="token punctuation">.</span>post<span class="token punctuation">(</span>jkgc_url<span class="token punctuation">,</span> data<span class="token operator">=</span>jkgc_form<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

    <span class="token comment">#get</span>
    form_url <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response3<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'entities'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    form_response <span class="token operator">=</span> sesh<span class="token punctuation">.</span>get<span class="token punctuation">(</span>form_url<span class="token punctuation">)</span>

    <span class="token comment">#post</span>
    headers<span class="token punctuation">[</span><span class="token string">'Accept'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'application/json, text/javascript, */*; q=0.01'</span>
    headers<span class="token punctuation">[</span><span class="token string">'Referer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> form_url
    headers<span class="token punctuation">[</span><span class="token string">'X-Requested-With'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'XMLHttpRequest'</span>
    submit_url <span class="token operator">=</span> <span class="token string">'http://jkgc.hrbeu.edu.cn/infoplus/interface/doAction'</span>

    submit_html <span class="token operator">=</span> lxml<span class="token punctuation">.</span>html<span class="token punctuation">.</span>fromstring<span class="token punctuation">(</span>form_response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    csrfToken2 <span class="token operator">=</span> submit_html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">r'//meta[@itemscope="csrfToken"]'</span><span class="token punctuation">)</span>
    csrfToken2 <span class="token operator">=</span> csrfToken2<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attrib<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>

    submit_form <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'actionId'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
        <span class="token comment"># boundFields 修改位置</span>
        <span class="token string">'boundFields'</span><span class="token punctuation">:</span> <span class="token string">'fieldCXXXdqszdjtx,fieldCXXXjtgjbc,...'</span><span class="token punctuation">,</span>
        <span class="token string">'csrfToken'</span><span class="token punctuation">:</span> csrfToken2<span class="token punctuation">,</span>
        <span class="token comment"># formData 修改位置</span>
        <span class="token string">'formData'</span><span class="token punctuation">:</span> <span class="token string">r'{"_VAR_EXECUTE_INDEP_ORGANIZE_Name":"学院","_VAR_ACTION_INDEP_ORGANIZES_Codes":"xxxxx",...}'</span><span class="token punctuation">,</span>
        <span class="token string">'lang'</span><span class="token punctuation">:</span> <span class="token string">'zh'</span><span class="token punctuation">,</span>
        <span class="token string">'nextUsers'</span><span class="token punctuation">:</span> <span class="token string">'{}'</span><span class="token punctuation">,</span>
        <span class="token string">'rand'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'remark'</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token string">'stepId'</span><span class="token punctuation">:</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">r'.*form/(\d*?)/'</span><span class="token punctuation">,</span>form_response<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'timestamp'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    response_end <span class="token operator">=</span> sesh<span class="token punctuation">.</span>post<span class="token punctuation">(</span>submit_url<span class="token punctuation">,</span> data<span class="token operator">=</span>submit_form<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    resJson <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response_end<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

    <span class="token comment">## 表单填写完成，返回结果</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form url: '</span><span class="token punctuation">,</span> form_response<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    <span class="token comment"># print('Form status: ', response_end.text)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form Status: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form stJson: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">)</span>
    <span class="token comment"># 获取表单返回 Json 数据所有 key 用这个</span>
    <span class="token comment"># print('Form stJsonkey: ', resJson.keys())</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'errno'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form Succeed: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        title <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'打卡成功 &lt;</span><span class="token interpolation"><span class="token punctuation">{</span>submit_form<span class="token punctuation">[</span><span class="token string">"stepId"</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">>'</span></span>
        msg <span class="token operator">=</span> <span class="token string">'\t表单地址: '</span> <span class="token operator">+</span> form_response<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'\n\n\t表单状态: \n\t\terrno：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'errno'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tecode：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tentities：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'entities'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\n\n\t完整返回：'</span> <span class="token operator">+</span> response_end<span class="token punctuation">.</span>text
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Form Error: '</span><span class="token punctuation">,</span> resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        title <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'打卡失败！校网出错'</span></span>
        msg <span class="token operator">=</span> <span class="token string">'\t表单地址: '</span> <span class="token operator">+</span> form_response<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'\n\n\t错误信息: \n\t\terrno：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'errno'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tecode：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'ecode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\t\tentities：'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>resJson<span class="token punctuation">[</span><span class="token string">'entities'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n\n\n\t完整返回：'</span> <span class="token operator">+</span> response_end<span class="token punctuation">.</span>text
<span class="token keyword">except</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n:.:.:.:.: Except return :.:.:.:.:'</span><span class="token punctuation">)</span>
    err <span class="token operator">=</span> traceback<span class="token punctuation">.</span>format_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Python Error: \n'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    title <span class="token operator">=</span> <span class="token string">'打卡失败！脚本出错'</span>
    msg <span class="token operator">=</span> <span class="token string">'\t脚本报错: \n\n\t'</span> <span class="token operator">+</span> err
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n:.:.:.:.: Finally :.:.:.:.:'</span><span class="token punctuation">)</span>
    <span class="token comment">## 发送邮件</span>
    <span class="token comment"># import sendmail     ## 这个是普通.py文件，不是Python库</span>
    <span class="token comment"># sendmail.sendmail(title, msg)</span>

    <span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
    <span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header
 
    <span class="token comment"># 第三方 SMTP 服务</span>
    mail_host<span class="token operator">=</span><span class="token string">"smtp.exmail.qq.com"</span>                 <span class="token comment"># 设置 smtp 服务器</span>
    mail_user<span class="token operator">=</span><span class="token string">"example@example.com"</span>                <span class="token comment"># smtp 发信邮箱用户名</span>
    mail_pass<span class="token operator">=</span><span class="token string">"emailpassword"</span>                      <span class="token comment"># smtp 发信邮箱密码</span>
    sender <span class="token operator">=</span> <span class="token string">'1@example.com'</span>                       <span class="token comment"># 发信邮箱显示</span>
    receivers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'2@example.com'</span><span class="token punctuation">]</span>                  <span class="token comment"># 修改为收件人邮箱，多邮箱以数组形式写</span>
    message <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token string">'plain'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    message<span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"1@example.com"</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>        <span class="token comment"># 发件人邮箱</span>
    message<span class="token punctuation">[</span><span class="token string">'To'</span><span class="token punctuation">]</span> <span class="token operator">=</span>  Header<span class="token punctuation">(</span><span class="token string">"2@example.com"</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>         <span class="token comment"># 收件人邮箱</span>
    subject <span class="token operator">=</span> title
    message<span class="token punctuation">[</span><span class="token string">'Subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># smtpObj = smtplib.SMTP()              # 使用一般发信</span>
        <span class="token comment"># smtpObj.connect(mail_host, 25)        # 不加密时 SMTP 端口号为 25</span>
        <span class="token comment"># smtpObj = smtplib.SMTP_SSL()          # Python 3.7 以下版本 SSL 加密发信</span>
        smtpObj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span>mail_host<span class="token punctuation">)</span>   <span class="token comment"># Python 3.7 及以上版本 SSL 加密发信</span>
        smtpObj<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>mail_host<span class="token punctuation">,</span> <span class="token number">465</span><span class="token punctuation">)</span>         <span class="token comment"># 加密时 SMTP 端口号为 465</span>
        smtpObj<span class="token punctuation">.</span>login<span class="token punctuation">(</span>mail_user<span class="token punctuation">,</span>mail_pass<span class="token punctuation">)</span>
        smtpObj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receivers<span class="token punctuation">,</span> message<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"Success: The email was sent successfully"</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> smtplib<span class="token punctuation">.</span>SMTPException<span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"Error: Can not send mail"</span><span class="token punctuation">)</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</details><br />
<p>合理地偷个懒，需要修改的地方都在代码注释里了。</p>
<h2 id="定时任务"><a href="#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1" aria-hidden="true"><span class="icon icon-link"></span></a>定时任务</h2>
<p>要想让代码实现自动打卡，还需要另外设置定时任务，Linux 可以用 <strong>crontab</strong>，Windows 可以用 <strong>任务计划程序</strong>。</p>
<pre class="language-bash line-numbers"><code class="language-bash"><span class="token comment"># Linux 下添加 crontab 定时命令，每天 8:00 执行打卡并输出日志到 .log 文件</span>
<span class="token comment"># 建议先运行测试是否可行</span>
<span class="token comment"># python3 auto-checkin.py</span>

<span class="token function">crontab</span> <span class="token parameter variable">-e</span>
<span class="token number">0</span> <span class="token number">8</span> * * * root /path/to/python3 /path/to/auto-checkin.py <span class="token operator">></span> /path/to/checkin.log
<span class="token comment"># :wq 保存并退出</span><span class="line-numbers-rows" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Windows 下按 <code>win</code> 搜索“任务计划程序”调出菜单，然后在右栏选择创建基础任务。跟着创建基本任务向导的指示一步一步来就好了，「触发器 -> 每日」设置时间推荐避开 6:00 腐败街预约打卡的高峰，8:00 就不错。「操作 -> 启动程序」的程序或脚本项按下面格式填写。</p>
<p><figure><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 870 686' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-779ae8e1118617cc54ca7e07fec05044'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-779ae8e1118617cc54ca7e07fec05044)' width='870' height='686' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAyCAIAAABj4UpDAAAACXBIWXMAAAsSAAALEgHS3X78AAAJVElEQVRo3u1Z%2bW8T2R13pf4d/R%2bqrfpLValdtVLbpb9UVaU9tGUFXdgSYHcrLW23QAMsbAjsbrqlkIUcEAhJ7CR2nDjxFdtx4tvja%2bL7Gp/je2Y84yuJ3e/MkEADm4SqglDlo%2bdvXt68mfc%2b73uOLcBxnKhUcvl8gUWxXC6XOBQ5VPcrKA75fF5QLhUUC3P3RseGh4eW9CtWq0WjWdRoFxcXVSarvdPptNvtzv5Dq9VKJBK1Wk1AUdVas1NrtGimtra2Xq/Xq1W62Ww2Go1Waw3239mXgGNdX19nGEZAV1IbuK6IhaulPH%2bl8yqAtwtWA0zOnV36q0E1Ew14YYgol7NZvFQuJRIYdIql8n4nQNN0LJk3mAyxWBSGnIhFMiNVyGdHHjwQTk7JFMqN9v4mwPkyHo1GwaNZ52g2wbDWWq16vcHUau39b0IQknYINe12%2b9UgsLGxwQ%2b1n8KrQeDlbqW941X%2bcPlpW33oPCJQqVTgD0gwegD0OR9Y2xWt1lZnD7OfdT8PXv98H4YhBUGHlWxnbcsunpCPiYEDC9wu%2b8jIgy%2bvXfv6X7empyZVKsXdu3dDkRhEJ2BF7IBKpcwBprEfDsTeQJIkxAwcz0HhYjIa7A4n3Asj2WwW1oUOW9EUS0SFsFvZqKhfXhYKx01m8%2bDgoFgsVioUoskpWAzqIEEqlSoU8pCWE1gin8/BI5KpFNy/6w5IggBdVWmaokiwQ1gYKpS97J7VOUP/44vev3x69sqVyx8c%2b8PxE13nzp873919/tzfpTOSj06f7L5w8dSpk2PCqXmx6Fe/%2bOVnly6//uMfdX1w/Afff%2b3QG4eOHH7v8LuHs7liPpcTmA3Lg4NDkxPj/bcH8HwRtgF62Xl5mmH8qOf%2byL2RERD3Bu8MSGUyjVpttTm25myT20CRxPjY6NS0RCgSoasogtiX9Xqj2ex0Os1mE8BoNGq1ukg0ZvU4J2RzOjtiRd2LZuPA6OiIWDolXxDKZEWayYEGQsGAHUHisVggECyVK%2bzB7sEACrmcd3U1FA4HAgGv1xfH4hiWgMzNl4o0zYAE/cBZMAzoBrRE8RUkb3VQ7XLVJEmyE1hADQbuRzN0bRONep2CG43m5ry8Kluoy1VNuWpNpakvKJh5OSWWkk4XXigIMtnsWquhVMjVWh2GJakqtaspA4FkKpHJZjAsHo5EstkMns1GIuFQMAiWCFSAFVzy%2bXzpTCYYDEGOB2PNsMhuum6rwZaL4KvNeoOLHptg/wE%2bNF1nmAZNZ776Ojwn887LzA8fmsYm7KLJsFIV1S1FRFOl4RG8XBZkWQJNC2jOYoFlYHO7EoCji8Wj4XDY6UBA3Q6Hw%2b1B7Xab2Wxxu12I0%2blxe/x%2bv9vlXFpaslhsTodj1et1uZweFN3gogeHda49C53OOkzrdCAopceFGEUag75BqeTu7JxIr7fE4vFmPZZKFUXTuWJR4PV6dfqVQDhSpWtgQKUKsXOrcGYNugctg97ZwrvOgj8%2bhoEoTPM%2bDYYBFkJzoDjLgk9lL9CvVBWqqlpDq7XlP/05030J77mOX%2bnNg/y8N3O5J9NzLX3m0/Kt2zhBCHwuq1wiRBFLs1ppMSS09RrZaVBPtzYna1XWhgr5XCgUisdjIEEVYCRgMOFwFKwEgmDliai6bW87hyeCpkkMy/fdSK4YUhptXKXOLRsyClVWqS7rlxOy%2bYxCmZyXl/SGnFhCPBjDSyXBhBnr1RWGrMUBI/7Alhu15m7qs1fVmd7F7e26JnNRkTaECq06HY2GxyfGp6ZEQ0ODA4PD6kXV3JxUOCVRKuUWqx1sbO85YRsBIhItDgy73C63YQW1mH0IYtMvozZ7OhJxGk0ukwm12TwIgsjmidFxHEzoN/9EBb93v9YX/eGN2E/64z%2b7g33vYlBwzPOdE6jgj//RvtuFCg67r8nTnSZZJiiwmhqXt3lrgS4J0ZEkd80hO8cHoljMPxRVpmWEZIGckVem5wjxPLTS1CwpWYAOKZkvT8sK94Vl7RJeKgr6lOF3xxJHx2NHJrD3hYljosRRrvN0Oy5KvDOKyTy59TqNxWOLGvXSkt4M7m82Ly5qDIYVjweNxbH/8vg3EwhE2ygkYpJiSwy%2bdth8r20/0a%2bvtwt0LYdnBeFVRDZ5XyuXrtepTpMz9%2bazWxtki2KqBFWlY%2bHQjHhapV70B/1Op2NlZVmj1ax6/eAG5LcQgJqDKzseFSD8dreKka0%2bBEEsk8%2bWqGp9jaq1oBF0g2SaJN0gNhsMFsl6oUywiSyOJeKJJJZMFUpEqcy24o6tzIUhiCr8iz/NJiyaC0h1mvu641uPlqpC7IIpYGwg%2bXAMT6huJj8wRzb9gRtAKKeqBFmFtUiKrjVaVaYOEhpTh7zRpNgFm2C6kAMEEDf4TPm8ut46uV0jDFyC58fj8XQqHY1ELFZrLBYvlkp4NiOVSiFjYBgWCvo1Gg1iRxwOF%2bTpVDIRDoWgSAv6fbe/6dfpdDdv3Xo4Ojp0p//6l32zM5K%2br/r8wUgJfCCdTj/v7p8XwLRRr1397MKp0x%2be677w4emTfzt7bk42399/8%2bKlS1C0dZ04cbWn58wnn5w9233mzJmJ8fHens%2b7uk7euPVNwOf99aE3enp63nz77cNHjr71u9/%2b9PWff/zxR2%2b%2b9Y7JaofDeREE2OhCEN5VFHK2B12FQsPtdoP6ggHInxE/ZBD24%2bPGPaFwJOBbFYslapVSrVlKJuJKlcqwsuJ0o3bEPiuRjI0LdTot1JHhSLRQKL4gAgCGcxT%2bhYmNuSTJ8CG4xmyBvboZlLnUTUNIAGfjwzVI/nUHngPykQ%2b8MAJP%2bskOlfaTE55O5I%2biFlfPwhGwLzQvjMD/HLDtAwIHBA4IAIFU6kADBwQOCBwQOCBwQOCAwAGB/xcClT2Pv2QC3E88j%2bTjEZKsUgS1bZCTVfIx%2bEvwzpnL5V4aAVg3lUqlOXA/HWTgv3wmZY/kZ5CU1pvV%2bnIaL842H77gzrjjhUwqkUgm4S54Fc5k0slkMhKJvBwCcIrRaGQVRW1mq9OBKJWK6WmxVDqXSiaMQXxWrnFYzUsa9cyMRCad8TjsjtXgih9PxKKxWPTe8PDIvRGT2QIH4PP7XxoB9susUNBmtaEoiiCI1WozW6xwxkBAYw%2b6vEGtCWGb0W51%2bQxozBTMJbEY3IXY7frlZY8HBVUEAoF/A7plcjGZ2sWXAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="870" alt="Windows 定时任务设置" data-srcset="/assets/static/heu-autotask.82a2fbd.22a101484c9f4d4a1d03d2ac7783f0f0.png 480w, /assets/static/heu-autotask.ae085b2.22a101484c9f4d4a1d03d2ac7783f0f0.png 870w" data-sizes="(max-width: 870px) 100vw, 870px" data-src="/assets/static/heu-autotask.ae085b2.22a101484c9f4d4a1d03d2ac7783f0f0.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/heu-autotask.ae085b2.22a101484c9f4d4a1d03d2ac7783f0f0.png" width="870" alt="Windows 定时任务设置"></noscript><figcaption>Windows 定时任务设置</figcaption></figure></p>
<p>Okay，睡个回笼觉庆祝一下 🥳..</p>
<blockquote>
<p>查看《<a href="https://blog.monsterx.cn/tech/modified-github-actions-4-heu-checkin/" target="_blank" rel="nofollow noopener noreferrer">照葫芦画瓢 · 编写 Actions 打卡工作流</a>》了解 GitHub Actions 版本。</p>
</blockquote>
</div><div class="post__footer"><div class="post-tags"><a href="/category/code/" class="post-tags__link category">
    code
  </a><a href="/tag/Python/" class="post-tags__link"><span>♯</span> Python
  </a><a href="/tag/COVID-19/" class="post-tags__link"><span>♯</span> COVID-19
  </a></div></div><div class="post__navigation"><a href="/life/daily-impermanence/" class="navlink" style="float: left">◀ 手帐 · 常</a><a href="/life/2019-annual-summary/" class="navlink" style="float: right">年度 · 2019 ▶</a></div></div><div class="artalk-cards"><details class="admonition admonition-warning"><summary><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></div>
        Comment on Monstx's Blog</summary><p>
        评论发表后 UA 信息、IP
        地址会被记录，分别用于评论区展示和垃圾评论拦截。<br>
        无特殊原因评论不会被删除，你应该懂得如何发表适当的言论并对其负责。
      </p></details><div id="LetsArtalk"></div></div><!----><div class="author post-author"><a href="/" class="logo active"><img alt="Author image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 180 180' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-cd5267957f4a1c7ec3bcfd7ae6302b1f'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='5'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-cd5267957f4a1c7ec3bcfd7ae6302b1f)' width='180' height='180' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsSAAALEgHS3X78AAAWZklEQVR42r1bCXgV1fVn8fv6t1ZrbTXsIO5IRQTBjTVAQmZewhoIYQuBJKwBLGgt1l2w0FotttT1E3erFUWlKioWBPJeAgn7KnsSwpL1JS/vvZnzP%2bfcO/PuvI2A2Pd9NzNvMvNmfr/zO8u9c2%2bzZj/iA269GXg0ua9Ra4nHWoSd80s83gs8eha2pbj/H7xmF%2b6fxq0fvwdwvxq3h7Ctw/YCtunY%2buD/r3b%2bFt1Db4nnK/fXm/3PPwSaHoY%2bJj2UB4EXulTQ7bDl4PFP8AFLYYsLYNcwgL3DAbanAWzF70U64P9EK8RG52xLBdiD5%2b3GVoz7Hu0M3ucr3C7E87qFkYFka81Dz/M/IsJUbkTWMD3qdy0Z27/wnFoGQaAJrEczhaXR4h4tiM1AQKY8bvK%2bm47h/9x6gJtHN5iUnUjYnuFElIn32oDbbNxephijpQWeiDB/KiJYbm5bes3JAsr/RmPzsHUJNFuXpS2AuHUB0gIt9iGsKccFMSYShWCD8rcAdqQJdXj0Y9gW4jmXSuD0PC1sN7nYbqFKjKyuACc/3chWIvDWwxJgtw0yGtiIZtLWrfFWNBe2VFM2%2bk4KCJpEKqmK3Mmt/YDXjg2pU7sk9MxosALtYlhe%2bnphMsnrEgn8/7At5wchqzBolrZiwXMDNyOAM2j8ngJQMBhg8wCrmVAwCH8zxSKDlOGHklRWHAJfTXHHjg1WYFZi1QVbXlFAS3mD7tj2sgXYlxl8CPh5WDwE3sUNNidiGwhm4QgIbp8NgT2PQWDf07h9BL/n83H8v4nn4T34miDHlt1EAmYSjzbSilPkFiqGC7a8BC/9S89k0ELu/pCVm2bxcLkL8GjFgiHcgrt%2bD77SL8BbfQLq6n1Q6wOobQSxbWjE48f5/8GdD6AiBmNLkorB4LrFUqP%2bpO0SHhkXPPr5ZQk7z3o4oDSX4Beyr1PKElH6vIFHBY8WN4qnQEPFZgWwwYDr6huw1fOWvvNx/r8JDSfX43WTTFaEICGIljdgH8eGtxUsCgmuJqQ5Fbxtee0Rjr50A5HCzkvu0WWfyv4d2L0I6rzVDEwFTAqIbAohdH7dWVTNg0yCVILJsQFJQOt/qLhyc6mIc4Nn4MWpzaw0x0WIyMPBEHj9vMFDNPB7HpfWDiIor5A9WZ6sTfvRGivDx%2beLa/3sOtFIwP13GEPJCEc8O3fE94h0gidnsuwjLQ8X1GTAowhvbMsTIBh8vZA4AcNtjbeBW4M/CF6fH6rr6u3/1Uo1CCLqmYS6uip2I4wjJv%2b%2bgwT9OYmtBRvYHaNqDPm9jPYevQdbuZAf3pAALhi86XCBoVB/pkTKPhJ80AQIYDtx8hScra4F%2bhAR0Unw8u9QDCFiqV6Q9zM5VonCKVuScElUFYQivi59Rb8ULz7AtbnHCnj6hVs%2bXPr7ljjA16ngEWxB0VYYnzUN7hswGAYm67Bk2bOsgvrGgE1CeGygABrY/QeRRrF4kmo1pAGxBNdvcWQGtT5QOjYy1%2bv/EJUWX3jBPh81AGLqqj9V5CRAgierb92%2bE37boze07Xwj3HBrN7i%2by23wmzYdYe6CB8FvAJ%2bnkmC7Aqmg/DuuJURdYafogEyPG8M7c6wEpWtpge8ne2JhNfyPBe/iXG8UZ2PUr%2bPgZVmQAJGF6TN7/gJoc%2b0NcFvPu%2bCWbj2gy%2b094dbud8K1N3WFTe4iVgiRUCeJs3%2bDYkntKTC3jEXDJQuyreemOkEY9H4nVs3q5GAvSnZncb%2bAGXNrF0f64fLf%2bxTL1U51SsQnP9dHjIbON3dl4EQANSKg4w23wMq332OSqpCscAJE4WRgRnhAqkBkBBG3NNGz9GhV%2bL2VxNnc7jRZKQ9dIIN7c%2bfw%2b8iOi1XHR/4vpAB8oE39oPHQi1DrB5nPQwRY/j9hSg50uP5m6HpHL5sA2icC/rP2G0AvYbXYBNgkCDfw71%2bKBPQH0WdQMaAK9nBq/Isa7B1dR9zfEurVRRIQCTDVjupQkMydGKtDE0mSJODwyggCqBEoArd6zRfQFl2A/F/Ivye06tAZXCPS%2bRw1G0Ql4Id/RCNANDEIU4etgx30LSbwZI3Bc68u0u/DOy/cY8Mbsb%2bh3xlbJ8rOiuzQSEWoZAkFvBpVAZYKKBC%2buvIt6HF3Hw6ARER65iTYe/CQHQQd4Ol6JRD6DzwXTkCUWKA9aavALnc9%2bkdC/pG%2bH1HCFgxCsMPAf/DvUH%2b6hIMPlaXemlKOxEFOR4NsRYRiQH%2bU6DKl7FXyukIEKeFYaTl8/d0GcG8p5vSngncoQE2F%2bLvUc6RYw/fzaEoc0kUsEAH%2bALafqdLvhM0rc2ZU66vgjW3TwVt1kC0pempBbIFQZwWb78Rn8sYpShYYDMFtM0Xhoz58GAkkdaoCiQiKC5Y6VJIiswBmFW8tGCXZnG34ftFGnEjhrHQ9Re33zxAVU8RoTlgJO4RvUFdXKa3oZeZrvPVQw%2bWq1VmpZ3Iayr%2bRD%2bN0H2/lfmcmCFOAVRcQEWrejwXeKoTqz2y3U6AZOysFeODVrb%2bqFkKrWf7czY0sd6MXMV7bWr6Awb5r1e12Z8UPLHlLkpYbNB56RcYBr6MSPO8WVggJ/x8Q7v/hKpBuoB%2biipfkfwW2E2L0VjciU5/lv4nU9bQtR%2bDrETC6Jvxw9DhsKdkBp6tqWLYsV2kVb%2bU%2bpf/v4oxhFqVjvCgXHRnZ1z9vEhwdIrxP1SH8/TTF5WIqQNQGXBfovcj6vfmLO3r/3o7gyGzj0XeFj3u9bO2qWi889MfHoXvve7lY6TsoGT5Y9UmoWpMPaaDfy45K1P5AnaOb6zsn8PDzRT9gkdUPsDNPHAKEG3j0WeT/uXKwI478xchNQ/k6fuiaujq29B8efQJ%2b3aYD3PTb7lywUAXX8cYusG79RlZGdZ1XPNyex%2byHswMiKsp37AMlJTacmwQHeKkyvL7x8GuhyB8fvBIHaNBEX0G9o%2bUiKNjpLw4B30INAvL5A3D42Am44677GLxVtlInph12YmbO/Z2s2Lw8fBXY82ikdcgtMED6jn0oVIVZxAqq4VauDQt49mAIXtd4ZCWn3PAiDeIpgAo90UFaRy6w1i6A3PFcAIPXkTegmixqYBzZsctRrlo1eydUwPisqdCIgVFE7QYe/Ai5QFipjMT49/9FZBY/2HHByibO5mNCWTU1J7lfISzfZPChQFjCgXAfucB%2b%2bfrKiDraYwUvCoI75nPO9/p8PFAxICkFe2m3Ys%2btN4PvdufdkND%2bWnhyyVLRafEaUH92V0RgCn8XQCCMrROg8dj7XExxbeEHu6aw9%2bne1UdR8q9jIB0jwbtoSJzeDfCWf9%2btnYsEQwb9E0RAvSiAYo/2qIVMQ8VGqGoAlLgJqz5dwwRQ3518n8AP1tK4ivP5G9ldAvsWO/wzeocqlVMsl7BFozCgPYyp8mXwHV8FvtLPMfi%2bhzX%2b3yG4E12rcLg4D/sewQKXAFskXrAaBZoNPi4JbtkvcOu1zUJlYlPG8pK45qcURq5gIAnrN26C/PsXwsTsHHj6T8vgeGkplq0mVHM1%2bKlD%2buY5X46kio4VugX1G8RboUTR5%2bDviQgyhYFDoUu8jsMMVrMuGfybUviNskpAbBLsFznBZuKtbPzxvohSuDibpU0kUMqjgNdosOqhgWr2ej%2bnTKrK1KBnNvkVWarSyMqpCDoVDDeC3prKwBs2DIWNL94Ny/JugvxhHWBheif%2bTiSQEuKqwMLqZgJ0X1NU4CRBlLf%2b/X%2bGuvKNUFN5FGqry6Dm9F5oOP4JGNtnCys2Abz9%2b9JiagsiEAZT5LLnFZR%2bPgg%2bfOoOWDC6E4zv1wom9G8N2YPbwMQBrSArsTUc%2bRjvW%2bxyuENUFxAveOqb8atmURXFHfqK7A5rQpos8TT0zZEyqg8QvcWwMYFYgNV9eujgZnmcnmk7ko3RuvrbJLbuX2fdDDnJbWFc3wSYMqgNTNc6wtQhrZCAVjA9pR0ff/PhbkxWsCCuC1gjRBXkAt/x6K/j7W5TX2OnhsYGyHelQuwusHVeFOsaBSHAbGWySEmq7ddn1w6BgpfvgRX338oSF9ZuBdOS2zPw7EEJkHH3z2Fm6vUwK%2b1GJKI1qqA1PJ19AwfFuDGA3L6EMf9AWeAF8eYneiEUS64hy%2bncDG4hYDZACdKSM19LYIvllBgqSHDfu34o7H2/P6z%2bUw9Yin49y9WeQVObOqQdgybrT%2bx7JWTe%2bwvIH9kF/vXSE7C7%2bHuYM%2bIWVEECTE5sAw%2bP7ywCYuwYIAohMfJVQC4gusKiEjTPB7xtOZITta2yEbji1JBFd8gJFHQMrVOPYI%2btToTC1%2b6Ffz99Bzw36xa4f2RH9mGSMVlyWhJZugPkJKF/97sSxt1zGRLRBp6ZPxy%2b%2b%2bwNqDxTzkH3w1eewv/9HPJSOsCkga1hUWZnaNyYws8VRwHyhYm2khTQX8hBN5r62sv%2bYbQg3ezs10Pg1JeDoWzNIDjxaSIc/WQgHF41EHa83RfWr7gbvnj2Tnjn0dvhnyjnp6bcAAtGdWJrkqQz%2b8pAhlbORRB5Q9uhvK%2bB8X2uYEvnDu0Ai/NdsPrNZ%2bHI/m2gfvaUbIQpiQlMDKsDA%2bHjk6%2bPXwuIDBAQA6T6QppMkIA7lTIQGvGygerDxPCnS3ty%2biG50oNPS2rLD0NRmdpktChJeFxf0QjopMS2CLY95CCwvBTcJreBKQN/AxMQMFk5a%2bDVMH9MN3h%2b0QT46t8vQdnRAw7QASyw6FN9tgIWZvaEyQN%2bjb/Rngmgey3P78LKi50F%2bJW%2bLIW1gdaI0Dp%2bCSreAMdVAcseLb8BLZt%2bzzUsWwI7LakdW0ttJEsCmYvk5CS1ZstO6v8rtiy1CejPuSkd4aHJ98DyR7JgzXvLYe%2b2TeCtrXKANk0TgoEA%2bBt9/L2uphL%2bOK2/uB7vQ6TnDhXZ4fNlPe0sEB28xmUwklOO36%2b03gr9PiwQmrEUwD%2bMN6DoTIzn4Y1zktuhn/4KMu66lIGRJa1Gx6dgxM7TOsHvMu6Ap1HOLy6ewZLesmENlB7ZZwNTP4YRhGAwgFsDjGCQt/QpPbofHsq6F8H/0gZPyqNGhiDXs4qhGAoIyMHfj9RB0duUStCMpQKVgJcXdoVMJICsm5V4Dbzx3APw7acrYdVrz7Al1370Mvz387egZPNXsG/7Zig/fhB8DV6I9bEBI1jTNNjqZhC3Ejh9/rvmbZjh6gyT%2bl3lAG/5P6fAwjBXdUR/LeKNcejNsFv/Xr4SC8bLBhYBa5/vhQEsgX1/ChKwKLsvlB7aA%2bf6EDACaYElyzJYarQfFE39HNxZCEsXjILx912BbtQK40d7GzzLHwmgYPo9lcKx5C8MLAsg/Sy2BHumpSRCGRmK7gZ26kMfKsOSlJgXD9Ae0vv8ApYN7Q6%2blR%2bD78wZ7h8QDAOtaaD/UjOpkYWpBeQ2zMq2InyN0FhQAiee%2bivkD%2bkI4/pczlafhu6mgres/9ik6%2bN1hEx7JEhY/2X7laBpzbd1a1dgK%2bU87rbHBmKTgFH0hbld2A2mowomJCXA31y94WzadCjLXgjVr74PjTv3gelrhKZ%2bghWnof77Qqha8RZUzHoETg7Pg/2pk2De0OtganJbG7Tl81ajbLP7vX529I9IgW77nYD1eqyHOoFKUYG%2bSAZDf7xgyDfBYofyPVsBM8CEIVfD8667oGr8AjiRPgNKU6dC2ajpUDH7Eahc%2biLUvLUKvGvWQQMCrFu7AWo%2b/xrqPvsGat75BCqffQVOL1wM5ZPuh9K0HL62lK7NnAsHM6bDvOTrYMqQ1g7QdF9yv4w%2bCfDeY7c7pO%2b0vtXz02Xw0z%2bSrwJbiNfj6lQ4D6rAI1XgnBAVUQRZsWDVkh4w7r5WMCn5GiSgN1SNQxAZs6EcH748Yw6TwKBcCMqVDWUj8uDQnTrs69gLjvUfA2XD8H9p0/h42ZhZUD4un68tGzcHKjLy4eCYXCSgs4MACzzFoMVTb4xapUL4i1FrVrpH6y6xtrAnQYdNkJjqiAVuZy8xvFNDQWXFvK4w/L6r4IW0u6CSCBg7C8rGzmYCyhFIeaYAxeAmzIcj/dPhQNeBcCJtKn/n49TofNno%2bmgE2ODR9R7KuBZq1yXzM8QYA7Cszy9F0erLw%2bIe/tk6zF74EJp2rn8DO9WRYi2qCgyrY4O9vyUzr4Mlg3pCdWYYAQogPoZEHOk3CvZ36Q/H9Sxh7bBzYxGQgwRwwYOyf3TidVD1TRIH5GBc8JjVirnndxS/X27NdndMlgqt%2brCnxN7IAyVFsusYxxWsAQufJwnWP5AEJ0fNQ/ki2Iw4BPQ9fwKmJovymqo9Cr7c4QkDHyZ9K/cb6stQRenRJ0bbcwTd2kQZNILOIilyQMPYjMe2p0Dw3Qw4MZzkTIAuHgFzkYCxfa%2bBmVp7WPtcL9HbLNIdsneC1xzzARDTM2FTAKPPExRukBI60a09y5MNPfZssagkmAU0mDEUvCvHQOmIuUxA2dg5F4WAA%2bm5MB/T4IoFXeD0l0M48HIqjprzldTt1hrl668vI%2bZCxppCHwqImqqMD8TUeL0xJgmSgIa3iICLpAC8/uTYfDg2IQ%2bOf4C%2bvl2MOQQLtFgFjxqs/bJzt5sym5X24oKPWCMgCyTJ3Bo599bv9C9JAhOQAr73R0PpyCYQwEFwQBwCxPVlo%2bfAqdwZAAVpYHi0WJIPB98oAzitQksIl/451w%2boqyzsdThb0%2bjiD%2bUiiYA9dVbemAnYmgL%2bz0aIBx8bAhGNgMN9RsL%2bm/rEJ4DcaFQ%2bnM7PJR%2b2h97UN0CiurNTncmWp8UTbHm9VQT4pq4eoUnFZmj6bAuFnOe5RghbM2DyMDNuN7qgImcGlKVHElBuEYD5/riWBYfuSeNqzyLHqZY5TEDp8LlQvXgyuxeRrAB3Wt3N4xhBOTn6W2yXq9P/yLXNC1k5okygVkig9YCoALFWyC%2bG0tgNTHQDs%2brJyfzgoUAY6Qpq4RNL/pYCyK3IvUIEKIs0eCIkWp0qV5a9/oK6rvBHryIzPaGLTVoqZwcSvRsvkyOXKOKy2c8EFKMbrB5pogLMkAJCSrDAWu6gfrfAW9Zn%2bc/JlTO9WPZCaaFhLTGIK9YyVOD/xihrGy/eEjrwpKjlMrVLlKxBa/dq%2bCEKWQV%2bJMGoeiLLLB2GKsicbarxIJwA576iGJI/BlPfu%2blkfZPJ9fAaAEMurDS5RuGZLfqr1hJbuYiyue3zu8Zc3BWjyuCJsnZQa4Px4nmeZkdEbMO6/HtX8NT06QF0BYNIQFBmuQAn9qNFfGl5bGZp2lyo%2bfNEU4I38N4Baqw2ikFF3GX/mNYkq5I3145XDKU1u%2bgftb8gl6a1VAjqiN%2bfxAc%2bDHtoxHUU1MzDbnHaXLNszJwAgqQWRKBGiARJyDjRykbnG6icYPWSSQHYkuLnRVDWumMxkFHJFndrd4YtnW3%2bk60aPdeqcVPMug4pojjlUswGw3H7Jm6PepdlgS93PtRPWADV4%2bfDGaubjMCRGMz1%2bVA2ci5UjJ4HNTNnAbyfCXAgVawMFbM6T%2bE9PhOLsUVqswIzpWnYlNYsam3/05OgORinMQVTWU/Mx04NvAwqBvaqf31s/unZea%2bjlYvQ4mXY/ETCyYmzzIqc6ebZB6f6vS%2bNO2NscB2E7UMLUUXvovUfRPCJ6PdXhamwJViDGWGB%2bkI%2b/w80aeNFRFgq7gAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="180" data-src="/assets/static/favicon.e6b6009.bb50f1698dfbcf84ee87f384c80e7647.png" data-srcset="/assets/static/favicon.e6b6009.bb50f1698dfbcf84ee87f384c80e7647.png 180w" data-sizes="(max-width: 180px) 100vw, 180px" class="author__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/favicon.e6b6009.bb50f1698dfbcf84ee87f384c80e7647.png" class="author__image g-image g-image--loaded" width="180" alt="Author image"></noscript></a><!----><p class="author__intro">一只怠惰的臭弟弟 つ﹏⊂</p><p class="author__links"><a href="/feed.xml" target="_blank" style="color:#f5a623;"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-rss fa-w-14"><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg></a><a href="/archives" style="color:var(--title-color);"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="archive" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-archive fa-w-16"><path fill="currentColor" d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"></path></svg></a><a href="/watch" style="color:#06a878;"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="dragon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="svg-inline--fa fa-dragon fa-w-20"><path fill="currentColor" d="M18.32 255.78L192 223.96l-91.28 68.69c-10.08 10.08-2.94 27.31 11.31 27.31h222.7c-9.44-26.4-14.73-54.47-14.73-83.38v-42.27l-119.73-87.6c-23.82-15.88-55.29-14.01-77.06 4.59L5.81 227.64c-12.38 10.33-3.45 30.42 12.51 28.14zm556.87 34.1l-100.66-50.31A47.992 47.992 0 0 1 448 196.65v-36.69h64l28.09 22.63c6 6 14.14 9.37 22.63 9.37h30.97a32 32 0 0 0 28.62-17.69l14.31-28.62a32.005 32.005 0 0 0-3.02-33.51l-74.53-99.38C553.02 4.7 543.54 0 533.47 0H296.02c-7.13 0-10.7 8.57-5.66 13.61L352 63.96 292.42 88.8c-5.9 2.95-5.9 11.36 0 14.31L352 127.96v108.62c0 72.08 36.03 139.39 96 179.38-195.59 6.81-344.56 41.01-434.1 60.91C5.78 478.67 0 485.88 0 494.2 0 504 7.95 512 17.76 512h499.08c63.29.01 119.61-47.56 122.99-110.76 2.52-47.28-22.73-90.4-64.64-111.36zM489.18 66.25l45.65 11.41c-2.75 10.91-12.47 18.89-24.13 18.26-12.96-.71-25.85-12.53-21.52-29.67z"></path></svg></a><a href="/friends" style="color:#ff0000;"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="heart" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-heart fa-w-16"><path fill="currentColor" d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"></path></svg></a><a href="/about"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="id-badge" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="svg-inline--fa fa-id-badge fa-w-12"><path fill="currentColor" d="M336 0H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM144 32h96c8.8 0 16 7.2 16 16s-7.2 16-16 16h-96c-8.8 0-16-7.2-16-16s7.2-16 16-16zm48 128c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm112 236.8c0 10.6-10 19.2-22.4 19.2H102.4C90 416 80 407.4 80 396.8v-19.2c0-31.8 30.1-57.6 67.2-57.6h5c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h5c37.1 0 67.2 25.8 67.2 57.6v19.2z"></path></svg></a></p></div></div></main><footer class="footer"><div class="footer__copyright"><a href="http://www.beian.miit.gov.cn/" target="_blank" rel="nofollow noopener noreferrer" style="text-decoration: none; cursor: default">皖 ICP 备 18021272 号 - 1</a>
      © 2014 - 2022
    </div><div class="footer__links"><a href="https://gridsome.org" target="_blank" rel="nofollow noopener noreferrer">Gridsome</a>
      ×
      <a href="https://github.com/spencerwooo" target="_blank" rel="nofollow noopener noreferrer">SpencerWoo</a>
      ×
      <a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=ztik1iwq&utm_source=ztik1iwq" target="_blank" rel="nofollow noopener noreferrer">Aliyun</a>
      ×
      <a href="https://www.dogedoge.com" target="_blank" rel="nofollow noopener noreferrer">DogeDoge</a></div></footer></div> <script src="/assets/js/app.797b8a92.js" defer></script><script src="/assets/js/page--src--templates--blog-post-vue.2214437c.js" defer></script>
  </body>
</html>
