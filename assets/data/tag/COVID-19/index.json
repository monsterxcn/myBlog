{"hash":"1e713c10770e8cb818c1cb41d17f22ea6038e396","data":{"tag":{"title":"COVID-19","belongsTo":{"edges":[{"node":{"title":"手帐 · 封锁之下","path":"/life/heu-in-amazing-walls/","cover_image":null,"date":"September 30. 2020","timeToRead":12,"cjkWordCount":2723,"cjkReadTime":9,"description":"2020 年 9 月的最后一天，挣扎在学业上的我回想起自己还拥有着一个博客。","content":"<p>本来 22 日打算就学校疫情防控下某一奇幻行为发表批评的声音，结果由于一些个人原因稿子写了一半放弃了。今天看到自己冷清的博客心里有点失落，索性将旧的手稿改写成一篇手帐。</p>\n<h2 id=\"生活\"><a href=\"#%E7%94%9F%E6%B4%BB\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>生活</h2>\n<p>开学接近一个月，我正逐渐习惯在学校尚未解封的情况下生活。</p>\n<p>封校对我而言其实并没有什么太大的影响，网购的东西依旧能送到菜鸟驿站，衣食住行基本都有解决的办法。只不过点外卖变麻烦了、不能和朋友出校聚餐、看热门电影了。乐观点，这些封锁倒是让我省下了不少生活费，在学习上花的功夫也前所未有的多了（当然也不排除我想到毕业时的焦虑情绪影响）。一个月的时间，我需要准备因疫情延误的上学期期末考试，其中的后两个月备考同时还需要学麻烦的专业课程。室友说考研大概就是这种感觉吧，每天都要在崩溃边缘挣扎。于我而言倒也没有那么夸张，因为一些实在是难懂的专业选修课我干脆抛开了。我每天不用考虑吃什么、去哪里，早晨起床就去食堂喝一碗朴素的粥，接着在图书馆、教学楼找位置看书。上午结束了就再去食堂找个人少的窗口打点饭菜，狼吞虎咽吃完回寝室休息一会，又接着开始一下午的耕耘。晚饭也是和中午一样，但是会换个窗口换个口味。晚上接着去白天学习的位置，9 点多回寝室唠唠嗑、看看稀奇古怪的应用推送，洗脚睡觉！当然这是最理想的情况，实际我还有一些时间花在了睡觉和发呆上。</p>\n<p>前两周我坚持的还算可以，后两周由于开始正式上课了，复习备考的时间几乎都被压榨干净，整个人也疲倦了许多。</p>\n<p>周一一整天都是补上疫情耽误的工程实践课，三个周一分别练习车削、特种加工、电子工艺。车削车床简直是我的噩梦，蜗杆正转还是反转我根本记不住，在老师的手把手指导下我成功表演了正反转不分、瞎旋进旋出，车了一个端面后人就宕机了。还好这是两人一组用一个车床，我队友一个人就车了一个全组最光滑的作品。特种加工倒还蛮简单，画一个平面图用 3B 代码模拟切割测试通过即可，旁边的人在画守望先锋里的武器，我想了半天也没想出来能画个什么，最后就对着哔哩哔哩的标志画了一个小电视的轮廓交上去。3B 代码写起来十分无脑，不需要什么逻辑处理，就是简单的算几个参数交给机器划线，无敌的我完成了自己的还帮同桌写了一份，成就感满满。电子工艺就是烙铁实践，时隔两年我再次拿起烙铁，心里五味杂陈。曾经还许诺自己做个科创大佬，现在啥也不是，连烙铁用起来都技不如人。</p>\n<p>周二是从早上八点上到晚上八点的辛苦日，上午工程电磁场原理课讲偏工程实际的电磁场的一切理论，是咱学校电气工程的基础课。接下来新时代习思想课，最先只有黑龙江省和北京上海开设的思政课程。上午的课程约莫十二点结束，一个半小时后下午的课开始了。电力电子技术，是模电数电大类之外的电子技术理论，才开始讲六大电力电子器件，接下来会讲交流与直流四大类基本变换：整流、逆变、斩波、调压。电力系统分析，电气工程专业课，分析电力系统的理论目前正在讲电力系统的数学模型、潮流计算。「潮流」是电力系统的专业名词之一，「手工算潮流」实际是讲给出某些值求解这个电力系统中任意一点的运行状态。这些课程听起来都蛮有专业的感觉，虽然不像数学物理理论那样抽象，但实际用到的都是这些基础知识（尤指电路），公式不好记且需要理解推导过程。电气工程这一体系在这些课程的讲解下逐渐现出轮廓，我深深感觉到高等数学、物理、电路基础知识在更加高深的理论中重要性。这些专业课普遍需要复变、电路的知识来支撑，各种数学模型、等效电路如果没有这些基础理解起来十分难懂。</p>\n<p>周三周四周五除了上面的课还有数字电子技术和自动控制原理。数电还算可以听懂，正在讲一些逻辑电路。数电老师十分关心坐在后排学生的听课体验，课前经常在教室后面和同学唠嗑，鼓励大家往前坐。这好像是我第一次注意到咱学校有这样的老师。自动控制原理，咱学校的考研课，用数学模型分析计算传统控制系统的性能。刚听起来这段时间和我上学期选修的数字信号处理有点相同的感觉，用数学函数表示输入信号输出信号，讲课过程中傅里叶变换、拉普拉斯变换张口就来，听了几节课我就完全蒙了。</p>\n<p>专业选修课已经开课的只有可编程控制器，讲的是用只有中国地区还在用的西门子 S7-200/300 控制器做小项目比如物块分拣、电梯什么的，实验课的占比很大，很多课都像这样不仅在理论上要求掌握，在动手实验的能力要求上也没有丢下。简单来说就是水课没得了。</p>\n<h2 id=\"读书\"><a href=\"#%E8%AF%BB%E4%B9%A6\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>读书</h2>\n<p>繁重的学习任务让我这个月牺牲了很多娱乐摸鱼的时间。但从这个学期开始，我读书了！</p>\n<p>中旬我在校图书馆借了一本《三体》，这是我一直想读的书。高三时就买了全套纸质书，还有银河帝国的全套，信誓旦旦计划要在高考之后好好读，结果后来时间全花在了追剧看电影上，三体也只看了第一部汪淼玩「三体」游戏的那几章。开学来打算将家里的书带过来，奈何行李太重了，小说就被我抛弃了。在图书馆借完书当天晚上我找了个座位看三体，越看越着迷，一直到九十点才回寝，旁边的数字信号处理书一页都没翻。三体第一部按我的总结是以纳米材料科学家汪淼的视角讲述了叶文洁在文革前后在红岸基地（和后来的第二红岸基地）与三体人建立联系并成立了地球三体组织、准备迎接三体舰队的故事。</p>\n<p>大部分时候，我对看书其实并不太感兴趣。小的时候喜欢看那些传说神话之类，读起来也许潜移默化中改变了自己的价值观、但最主要的还是感觉故事情节有趣。后来我也只是在《少年博览》《科学 FANS》中找故事读，没怎么读过文学著作。这大概就是为啥现在的我品味素质修养都不太高的原因吧。初三读过《斗罗大陆》第一部，高中读了一点点《雪中悍刀行》，这些书我觉得都不是拿得上台面的，让老师看见了指定要被没收而且批评。而《三体》作为屡屡获奖的科幻文学作品，其中的物理知识给人一种「亦真亦幻」的感觉，就算让老师逮着了应该情节也不能算太严重。读完第一部三体之后我接着借来了李淼的《〈三体〉中的物理学》给自己深度扫盲，借刘慈欣为李淼作序《比科幻更神奇的科学》中的一句话为这本书做总结：</p>\n<blockquote>\n<p>他（李淼）并没有像一般的读者和网友一样，专注于挑小说中的硬伤（在这方面他无疑是最有资格的），而是以《三体》中的科幻内容作为引子和起点，描绘了一幅现代物理学和宇宙学的宏伟图景。</p>\n</blockquote>\n<p>这本科普我目前才读了一半，我对后面李淼「从物理学的角度」探讨「自由意志」的命题十分期待。我越发觉得数学、物理基础学科是如此的神圣，只有天才才能掌握吧。</p>\n<p>借到三体第一部之后一天我把所有的复习工作都推了，一心读三体，驰骋在浩瀚宇宙中希望有一天自己也能到达那里。第一部读完之后我立刻去借了第二部并且以更甚的热情读完了，罗辑的那句「我对三体世界说话」真是太震撼了！最后一章，人类面对比自己强大无数倍的三体世界几乎没有丝毫战胜的希望，唯一的面壁人罗辑作为最后希望也失去了人类的信任，但即使这样被人类驱逐的罗辑还是扭转了局势建立「威慑」。这一部中刘大对宇宙文明法则的思考我觉得堪比阿西莫夫机器人三大定律，太神了！如我在众多日漫中力推《进击的巨人》一样，《三体》也将是我在科幻文学的前排推荐。</p>\n<p>第三部在图书馆没有借到，我便借了另外一些书，比如《冰与火之歌》《梦的解析》《黄衣王》。《冰与火之歌》是 HBO 权游的原著，《梦的解析》大概是每个心理学学者必读书籍，《黄衣王》大概是和「克苏鲁」一个范畴的小说。其实还打算借猫腻的《庆余年》和紫金陈的《长夜难明》，但这两本都借不到，估计是改编电视剧热播带动的吧。</p>\n<p>我真恨，为什么前两年花了那么多时间在看无意义的视频上？</p>\n"}},{"node":{"title":"手帐 · 常","path":"/life/daily-impermanence/","cover_image":null,"date":"May 18. 2020","timeToRead":17,"cjkWordCount":3893,"cjkReadTime":12,"description":"久违的手帐（日记）更新，再不写一篇都快忘记这是个生活博客了。翻了翻归档，上一篇正儿八经发布的日记是一年前了，断断续续的日记草稿质量堪忧。","content":"<p>最近的日子过得忙碌，五味杂陈。这种状态持续了多久呢……</p>\n<h2 id=\"生活\"><a href=\"#%E7%94%9F%E6%B4%BB\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>生活</h2>\n<p>大概疫情开始后我的生活就变了吧，刚开始时是铺天盖地的谣言与辟谣，以及每日新增的新闻，我想：像我这种从不门、连屋子都懒得出去的人来说唯一能让我动弹的只有快递和外卖，而现在只剩快递。心里默默计划的返校从 4 月拖到 5 月，眼下看来还要继续拖到 6 月，而原本计划返校再做的一些事不得不在家里完成，比如补考。嗯，在家学习的感觉不算太差也不算太好，前半句是因为我不再需要从众，没必要做样子给谁看；后半句则是因为在家也免不了走神，课上着上着就想到了浏览器，今天 Feedly 的朋友们又整什么活了吗 / GayHub 的朋友们又发现了什么新奇玩意儿吗？</p>\n<p>也许让疫情背锅也不对，从安卓换到苹果之后生活改变了许多。自从一加 5 不再工作，我换上了一年前买给妈妈备用的 iPhone 6s，在这个三摄四摄呼风唤雨、苹果华为针尖麦芒的时代，手里握着这轻巧的 6s 可谓复古了。折腾了许久，翻越高墙的梦想还是不能在 6s 上实现，想了想被我刷成白苹果的 i7 我还是不再考虑瞎折腾了，翻什么翻？憋着！用惯了 Android 的我看来 iOS 还是不适合我，最让我头疼的是复制文件居然还必须走 iTunes，啊这？也许正是这些不习惯，让我戒掉了对手机的过度依赖，然后，转向了对电脑的过度依赖。在家有网有电，不像在宿舍玩到正尽兴时断网断电了，我的电脑也渐渐开始像一台服务器一样工作，白天网课、浏览器、VSCode，夜晚下载、挂机、自动更新，只有我哪天突然心疼本本了才会选择让他重启。原来花在手机游戏上的时间开始成为我瞎折腾的资本，这段时间除了上网课的时间我几乎都花在了浏览网页和写 Bug 上。重拾 C 语言，看看 Python，学学 CSS 和 JavaScript，想干啥就干啥，不像在宿舍。在宿舍里写代码有一种异类的感觉，我更希望大家在寝室一起联机快乐，而不是我在做着他们都不理解的事情然后他们发出不明所以的吹捧「牛逼啊」。</p>\n<p>又或者这一切既不是因为疫情，也不是因为手机电脑，而是因为身边的人和事。今年过年的时候格外冷清，我觉得似乎上了大学之后这样的年就成为常态了，不像以前叔伯姨舅都会回家团聚，今年刚好就着疫情的由头谁也不回了，大年夜只剩一家五口围着咕嘟嘟冒泡的清汤火锅抿一口健康的王老吉，清心寡欲。二姑走了很多年了，家里人一直瞒着爷爷，刚开始的时候我看着父母亲朋在饭桌上编理由糊弄老人，现在爷爷似乎也不再问起，我对这事感觉很微妙。现在二姑爷也病的不轻了，我不敢想象以后的事。最近呢，舅舅也不知道什么情况住院了，从县里转到市里，妈妈不跟我说，但是我看着她时常精神不振就知道舅舅一定病得不轻。想想舅舅那么爽朗乐观的人，现在也不得不戴着呼吸机躺在病床上，这种感觉也很 <del>微妙</del> 不妙。妈妈就这件事时常警告我不要熬夜，要我早睡早起吃早饭。我也想过啊，可是有的事情成为习惯就不想改了，夜晚宁静得有种与世隔绝的感觉，做什么都不会被人打扰，没有 QQ 消息，没有微信通知，群聊变得安静，整个世界都变得清净了。这个时候开始，无论是突击作业还是敲击键盘写博文修代码，总是感觉十分舒适。哦，唯一让我头疼的就是妈妈的催促「几点啦？赶快睡觉啊」……</p>\n<p>谈及生命的时候我总会想自己的未来。不知不觉大二也已经快过完了，曾经幻想中的步入社会就在眼前，可是当我走到这一步的时候却发现，我为了这一切做的事这么傻。我在父母的监督下学习，在大学的宽松下放肆，以前每天的学习就为了考一个像样的大学离开家乡，现在每天的学习就为了及格万岁。大一的时候认为这些数学物理学了又有什么用处呢？不学！现在接触了专业课才懂得什么叫「数理基础」，原来一切需要这些基础。那些年少无知的想法让现在的自己追悔莫及，一种 <em>多年的义务教育都将葬送在大学四年</em> 的想法在心底滋生。刚进入大学的时候我以自己接触了博客而自豪，现在却觉得这么多年了我的长进是那么微不足道，我总是三分钟热度学个皮毛就弃坑，而别人自学一周也许就能比我更懂 Web。身边的人就像这样默默的超越了我，只有我还活在从前。我觉得迷茫，我的人生漫无目的：未来会成为硕士吗？可是我的专业课学的一言难尽；未来会成为电气工程师吗？可是我似乎连电路仿真都做不明白；未来会成为程序员吗？可是我连前端三件套都没熟练掌握。当我否定掉这三个规划的时候，我便恐慌起来，我的人生就此失去目标了。一旦毕业我连找父母要钱的理由都没有，我从来没有考虑过如何生活。小的时候我觉得生活不过就是毕业了找份工作拿着几千一月的薪水，找个住的地方日复一日。现在看来那样的话真是糟糕透了：几千一月糊弄自己还差不多，父母呢？我有什么脸面让父母继续卖命？爱情呢？这样糟糕的糙汉子只有梦里才配拥有爱情吧？</p>\n<h2 id=\"代码\"><a href=\"#%E4%BB%A3%E7%A0%81\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>代码</h2>\n<p>太糟糕了，还是谈谈现在吧。学习之余便是代码，这一段是最近在 GitHub 上的「工作」。大约一两个月前我突然对吃灰已久的 GitHub 账号产生了想法：让 Contributions 绿起来！一直以来 GitHub 是我找资源的首选地，各种 Gist 和仓库，总是有相关的资源可以借鉴，前段时间折腾 WSL 的时候 Github issue 和 wiki 区一度成为我反复翻阅的地方，和 Stack Overflow 类似的，这里能找到大部分合适的答案。回到「工作」上来，最近做的事就是修改 VOID 主题了（顺便的还对 AlanDecode 大大的主题配套插件也动了刀，目前自己用起来是舒服了），虽然博客挺长时间没有更新了，但是对 VOID 的二次开发却一直未间断，甚至还像模像样的发布了两个小 Release。Git 的基本操作也学会一些，至少 clone commit push 一条龙算是熟练了。可惜，JavaScript 和 PHP 方面我一直都是萌新，甚至从未仔细学过他们的语法，这导致我的二次开发效率蛮低的，很多地方都是仿写，想做到没有冗余代码的地步我觉得我还有很长的路要走。本来是以为二次开发不久我就能在博客开心的宣布：VOID Done! 快来 Star 吧！结果随着二次开发的进行我越来越觉得我的代码写的实在太差劲了，为什么这个功能我做不出来？为什么这个功能要插件？现在，我连在 Alan 大佬的博客评论的勇气都没有了。（Alan：啊这？我原来写的这么工整规范的代码你给我改出个这玩意儿？）每每想到这我就一咬牙，绝对不能把这东西发博客，太 der 了！</p>\n<p>真正自己做着主题维护的事情的时候，我就开始看开一些事情了。为什么开发者不回答我这个问题？我给你 5 块你把这个功能加到主题上好不好？博主博主你这个页面是怎么设置的啊？这个代码直接替换吗？换友链吗？在？…… 每天逛博客逛 GitHub 逛主题售后唠嗑群，我都能看见各种问题，至少 QQ 群里的问题层次其实都比较低，有的连问题是什么都描述不清楚。这大概是为什么 QQ 联系在程序员界算是被嫌弃的一个原因吧。被提问的人是什么感觉这因人而异，但是对我而言，我就觉得：这个问题很难吗？你自己动手试一下不好吗？同样打字的时间，你花在搜索引擎上效果比在这一两百人群只有几十个活人的地方效果更差吗？还有对于在主题售后群里聊 DD、cc、翻越高墙、散布链接的行为我更是深恶痛绝，几乎我加的每一个 QQ 主题群（从最初的 Material 到 Handsome 再到泽泽社长的群）都免不了这些。恶意攻击也偶有发生，但是链接还是会继续散布。主题售后群里时不时就丢链接的博客质量参差不齐，毫无意义的搬运不在少数。用点心思在文章上自然有人爱看，这道理很难懂吗？在这里只想借用 Alan 大佬发布 VOID 主题时的一段话：</p>\n<blockquote>\n<p>我希望使用这些主题的博主，能认真地多写几篇正经文章，这才是独立博客的精髓。一两句话的牢骚，大可以去微博与 Twit­ter 上说；花花绿绿的代刷广告与盗版采集还是免了吧。 <sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n</blockquote>\n<p>当然，我也并不是一个优秀的博主，翻看我的归档就知道其实文章都是一些大佬看不上眼的东西，有的时候文章不删反而更容易激励自己，大概类似「反面教材」的效果。到 2024 年，如果这个博客还继续产出的话，我想必会回顾这十年的历程，从最初到当下审视博客的变化。说到十年我又想到了一个叫做「<a href=\"https://foreverblog.cn/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">十年之约</a>」的项目，「从加入这个活动起，我们的博客十年不关闭，保持更新和活力」。对我而言，不需要任何「约定」「承诺」，我也会保持这份写博客的热情。实在是很难想象我这样一个三分钟热度的人居然坚持做博客这么多年几乎未间断！我十分期待有一天不再需要谷歌、不再需要过滤脚本，在地址栏输入中文，大家就能轻松获得详尽的中文资料。（记录一些最近发现的我觉得很棒的博客 <sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup>）</p>\n<h2 id=\"网络\"><a href=\"#%E7%BD%91%E7%BB%9C\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>网络</h2>\n<p>谈及互联网内容，最近的瓜真是令人无语。什么 AO3、罗志祥、papi 酱…… 我真是搞不懂了，疫情期间闲着没事干是吗？有的事情确实挺令人恶心的，但是吃瓜归吃瓜，拿关注明星污点、翻黑料、瞎打拳的时间花在改善自己生活上不香吗？明星终究是明星，就算我拿着相机怼到人家脸上拍到了照片，咱们的世界也是截然不同的两个世界，非要说有点联系也是虚无缥缈的。</p>\n<p>以前，这些明星黑料的生产商是微博，和我的世界很远；后来 QQ 有了看点，不过还好，可以关闭；现在，连哔哩哔哩也变味了。<del>我不知道是我的个人原因还是怎么了，</del> 我的哔哩哔哩她十分不像从前了。不谈每天推荐的某某正式入驻辣，连每天热门的榜单也五花八门，有的时候我刷新半天又半天都找不到一个对胃口的视频。我甚至下载了以前不屑一顾的抖音来消遣刷不到哔哩哔哩趣味的时间。</p>\n<p>就我个人来看，哔哩哔哩开始走上一条悄悄远离二次元的路了，不管是公司高层的战略决策还是国家的隐形政策，她的确开始「变化」了。要说从什么时候开始有这种端倪，我觉得是央视表扬哔哩哔哩之后。舆论让哔哩哔哩越来越意识到自己其实有潜力做一个不只局限在二次元的公司，于是「变化」产生了。怎么说呢，我并没有觉得这样不好，但是就我自己看到的内容质量而言我觉得情况不太乐观。</p>\n<p>说到这，我想到了哔哩哔哩弹幕的问题。弹幕弥补了视频中的不足，也拉进制作者与看官的距离，实在是高明的设计。但是低质弹幕却让人头疼，试问人们对二次元负面的一些刻板印象是从何而来？我觉得低质弹幕难辞其咎。关键词屏蔽能解决一些，但我还是希望从根源、从用户意愿上解决问题。随着社区规模的扩大，如何界定和规范用户行为，也应该成为视频平台用心考虑的问题。B 站风纪委员会希望能做得更好。哔哩哔哩的变化我觉得很大一部分都是因为涌入这个社区的人，规模扩大但不应该降低门槛，降低门槛不应该下限太低，如何找到一个平衡点让用户质量和社区热度都得到保证是一个难题。</p>\n<blockquote>\n<p>破案了，哔哩哔哩还是从前那个哔哩哔哩，我不是从前那个我了。</p>\n</blockquote>\n<h2 id=\"end\"><a href=\"#end\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>End</h2>\n<p>写写停停，一篇普通的日记花了三个多小时，又是一次无意义的写作。</p>\n<p>写完再看一遍觉得结构实在是糟糕，但是又不知道从何理出一条线索来，索性就着 Markdown 标题简单提炼了一下。脑袋里装的稀奇古怪的想法没有什么人值得我倾诉，家人亦是如此，所以还是写到博客里痛快。以前手写日记的感觉很难再找到了，敲击键盘比拿出纸笔似乎更加容易，尽管如此我还是不知道下一次日记会写在什么时候。一切随缘吧！</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>《<a href=\"https://blog.imalan.cn/archives/247/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">VOID：现在可以公开的情报 - 无文字|三无计划</a>》</p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p><a href=\"https://beyondstars.xyz/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@探索子</a> <a href=\"https://www.mina.moe/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@MiNa!</a> <a href=\"https://blog.ichr.me/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@ChrAlpha 的幻想乡</a></p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>\n"}},{"node":{"title":"Mark 并调试 HEU 自动打卡代码","path":"/code/heu-auto-checkin-covid19/","cover_image":{"type":"image","mimeType":"image/png","src":"/assets/static/auto-checkin-covid19.a209973.c87091a851f8ca767e5cbc6ea41ac4d9.png","size":{"width":1280,"height":400},"sizes":"(max-width: 1280px) 100vw, 1280px","srcset":["/assets/static/auto-checkin-covid19.a67b0b2.c87091a851f8ca767e5cbc6ea41ac4d9.png 480w","/assets/static/auto-checkin-covid19.a209973.c87091a851f8ca767e5cbc6ea41ac4d9.png 1280w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 400' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-e9f822d21a3f4fb948604bebd5e5f005'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-e9f822d21a3f4fb948604bebd5e5f005)' width='1280' height='400' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAUCAIAAACyFKxoAAAACXBIWXMAAAsSAAALEgHS3X78AAAJOElEQVRIx21XWW8b1xXmD0lbicNluO8iKVLiNpzh7Jwhh8NNi2VqsyxZuy1brpfYlpLa9ZI6dpM0St04TaIoCWKrSWqgqJHABtrYTVsUbZ8KJH1o6vil7Q/ombnkiLYDXAwOee%2bc%2bc4531muCXNQsCzOgsPHdcm81VXAnCBT2v/OQq%2bdhJ/uAI97GLND%2b2l103DG6qLhPLxlximbm7G5aaQEZNzLdmQa97aVw3kkg2ZdZo2PwivoAPoJT7uHRQIsgIG2kGx8yGS8r%2bsqoEPGE/4HZLiX7usvclxVKTdKcoPlquGoAAd6bKSui0FK7B4GPmkARTIYCUqQKvRVENDnQHMHEL8H1M93A9VlbQvOG84CPZoSXbMJ7ekb5NOG%2bnlwdrCPK8nVqtqoq82a2lTK1UpZrapNhlFiCcHhZRAg4y1ArIMjkRlOP2%2bYhGTkewDdbQwyz9DThtiOA9MJMgnRM3wPb8Ey6aBZjTAOZBxjOAz30OEYVypVVaVWLlXLJRWeJVmFBUJNrecIudfeJgwC1E0SZIyuEIXUAMcYJLFo5MwjcLBrxARMNQLbDRqiqmOjDK8hChW%2bi2SML8RwXFmWFKlYKYplgZOkogLoZVhFBf4XRcXlA3x7Gg0KWbQ4dJJK872gsRE%2b5CyADB/SkspBpclRVpzKM%2bMUP1HgJ4KxMliiIdPNQ1iNpNKVkx1/tZWbEEe7SdYha8EfolmmKPAyLJoWSJIFG0ShBIvjJJ6XZakcT4o29x7vjTh0kkojjMWetTnzmD1rdRAYTlgd%2bV5r1hUArTNldY4Rp7LkEMm0iuVZWZ0lmJZVR2nG87iPt3t5DNgIkCCp2goLemBpFNjuHEAkY2EPuSGRJJkCT5Ecy4g0xazPHzizOCHyRbogqFKJoXmOFbNE8akERYHWZC2wJB4oYuRxc/8kFttvJ1atfcPmYM0arrPDzxcXbmQr6%2bmxl9O1s5nRy%2bTszTBxgBm/3EfN9iZmrMlpjDiGZdcsyRlbfs0crGrGuxjcx3UnVdsAg3AgtOPgogOhDElQilTK5uifnFn739/u/PXXb8y1RlJp%2bvqZlWFFJkkukxUQfUEXCrdFIwmqKgUMz9vDFYzdwLgfmdWfY%2bJFTN3qEa%2bERl4nxy4lx7eofReCynk7fdouvOjf91a%2bup6rnVJa59ziprVwEiucxphNa3rRVryIBVWLbgCqrR2mMCajfoELYQ/QoIqOewWrc3BiSP3y1vWGWv3xidXPt69%2bfX976/wPi4L874e3NlZnMlk6n29HoKt6UEaV0JQ7aSCPPToEXsdcLOYtOiIqWzoUTQ0R4lwstz%2bYbNClBYKdcidGUlSr3FyRq/MDhaket2j1l2x9Q5hHxMINi78MRcXc1anaOQBFqqvdsEZpg/9dvkyRF/7%2byavXNo9f3zz%2b1f33vnl4%2b%2b72te2fvvjowYfnT6yAAam04A0JhhdQghrVoy07KbsLGJWH1LQ4SLubrg0tFZVZSZnhpalqc2lpZXN%2b6RzIsjrHFqcbo6usOPk9cwZOOr2MlgPge9RSOwYg2FoOoFQwzNATEZ0jzXbCbA0fX5j86t7OF7tbQKHHf/rVvx7eevzH3TtvXqpXqgTBuwO0xYiAkzI7nqjcbTOg/thBWx4AAQ6woVJfqNTm4SlVZgX5wPDYWnN0mZOmy9V5SZkbGTsMpen7WAYw6DGkjEqDFKL2iqqt6YnK3dXewQyKa01NLy4tr23fvPH7OzuP/nDr0Ze3v3l46z9/%2bfgXV84GwmQswds97eINueXw0IFg4dnKjfsFZ7iMByRPrO7uq7r6VL6yINTXxPqRJLEvSU2W64tS80g0O0aJM5lCi5QXs8yEO1aHk3Z/0e4TvDHI4DzWrpac0eMgJUzGl/TCx6GpBswQpKGpmcXRiTlWbg5PLt77ZOfxgw%2b/vr/z7cOP/vvn22PN1nOWrDvIId%2bDj3vwAjHIVmihF6c6DR9GIwYc7x8cG1RODpaO9RfX0tUzcX45X1pqLr9WmdwsT54vz13Pq8fokXOUerQ2taHsPzO08npSPjogr8e4ZXe0BqUp09hwBEsQQMsz/DR1t/pOHLTy5/EnfJHBaIoJxHLTc6t3t6//8/Ob337x/j/u3jy1vNqLa0FEvtc6oM6NMkkLObbX0RmNtNbD9dpy3sQwMXohQs700YeSpXUABH5VZ6/w6jLfONo4fIOvHZH2nWbr68XRU8PLr8qTF%2bLiWpicCeWmPRElMLgvxq9aPRyut2EjsKghmIyURRuY1goYX7wZjJe8wf5gdDAYzx04dPiDl09/9trRt186OToyHklIKUIdzCqGpyECQoYa4ahGgRqIUUZb0Pzipl0h2R2t%2b1P7cZ/gDsnOSKXHmnVHymL5oFxfATMEdUlUDgnVZbm2mCLHHCEFmAasg5M2DwfQ7eBZvTV1T25oNDIZVcmi93xvtB4aHIvnD/ZT833pMW8o7fRGhvYffPfyiTePD3t8EXcg3j%2bQSedIilGhB4ObgTMeL1mlciqZq8Mzn4UJ74mZGaoz1AMbAZ%2bAhgpsRtSCA30JpcC10vnhXGEsS44EoqUeWw56MOw6NKAUAto986KJwehaJmN8gL7jjTXC6YlwajyUaoVTrUh6KpxuOXypgli9cGz%2b7DifSiatzgCGe%2bKJtC8M9wStfAH74xFCzaVKmZSSS0nplM2lzVddo1FB73SCkWydTkfBJIeQgfADK2HzMF3jzN5YuRfqPQoBPxngsJYD%2bhhI4j7JGxvyRJvw9KEVH4bljlSSWfHqqYVXDpdvXz0aCEVd3mA0KVjdWusF6gPpE305aTAmDCSkdJJJDlidT1Xk9oxt3DTad5fO/IyuTU81EJRjhu91hFx310LeaVchrYsFSvaggsMKVfCQ6gipzrDqCNecweLsSOql5w99en3%2bd2%2bdfePapc2NF5ojS8HEcK9LfA7LAbJAWKAGiFIuxQ/EiWh/Z37WJzknZVy7UMbD9No1Mz/T9cC7XWMl6gBP3jf2ulb7QoPuRFaPYHELFnh6RIu3aIXlk2x%2bqQfPk3l%2b%2buDyyuLqvbcvPvjtx7vvv/PZpx/t7rz7wsbFc6c3f7n1s92dd36z%2b8F7W9f4gX4iEnJ5SGdANCb%2b7gvXdxLD2LVrFGpfUMHBXXc91pgdwObuwP4fenLbqpcgDcYAAAAASUVORK5CYII=' /%3e%3c/svg%3e"},"date":"April 5. 2020","timeToRead":15,"cjkWordCount":3549,"cjkReadTime":11,"description":"找资料逛博客的时候碰巧进入了一个学长的博客，发现了懒人福音的自动打卡 Python 脚本。本文记录 Python 萌新的调试过程（造轮子不行，用轮子一流..","content":"<p>最近这几天又不知道干点啥，天天上课累死了，前面的还没掌握就又要接新的知识，真是太难了。心血来潮想好好学一下 JavaScript 什么的前端基础，找资料逛博客的时候碰巧发现了一个学长的博客，看到《<a href=\"https://zjw1.top/2020/03/10/auto_checkin_during_covid19_and_cas_sso_learning/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">疫情期间自动健康打卡暨 CAS 单点登录认证实践 - SiteForZJW</a>》这篇文章，常年起不来床的我赶紧点开了，啊啊啊我为什么没有早点发现这种好东西啊，生气。</p>\n<p>第一次看的时候了解到这个 Python 代码要自己先手动执行一边获取表单数据。Emmm，那是啥，好像不太了解呢，先 Mark 了！</p>\n<h2 id=\"python-和依赖\"><a href=\"#python-%E5%92%8C%E4%BE%9D%E8%B5%96\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Python 和依赖</h2>\n<p>什么？你说这个年头还有人电脑上没装 Python？なんと！</p>\n<p>Windows 系统直接上 Python 官网下载安装包，注意将 Python 安装目录添加到 PATH 环境变量，一并安装 pip。如果运行时显示缺少模块就 pip 安装一下。</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\">python -m pip <span class=\"token function\">install</span> --upgrade pip\npip <span class=\"token function\">install</span> requests lxml<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<h2 id=\"获取-form-data\"><a href=\"#%E8%8E%B7%E5%8F%96-form-data\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>获取 form Data</h2>\n<p>今天早上起来的出奇的早（7 点半我就醒了），一想到学校的打卡十点前就要完成，我突然想到了那个自动打卡、表单数据的事情。于是我点开了浏览器开始尝试。</p>\n<p>打开 <a href=\"http://one.hrbeu.edu.cn/infoplus/form/JKXXSB/start\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">网上办事中心 - 平安行动</a> ，虽然不知道是啥，但 F12 肯定会告诉我的。选择 Network 栏，网页从打开这个菜单后加载的所有请求都会在这里显示，先刷新一遍网页，找了一遍好像什么也没有（一开始我以为表单数据是缓存下来的什么东西），Emmm，提交一遍试试，点完确认提交之后 Network 最下面显示了一个新的名叫 <code>doAction</code> 资源，那一定就是你了！<strong>注意此时不要点确定，点确定之后该资源会被刷新掉。</strong></p>\n<p>好的，<code>Form Data</code> Get√ 。选择 <code>view parsed</code> <code>view decoded</code> 就能看到这个表单的所有数据，也就是之前 Python 自动打卡需要自定义的。完整存好 <code>formData</code> <code>boundFields</code> 的内容。</p>\n<p><figure><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1901 1000' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-b614ee0887ec85536d75e1e090ff7ac9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-b614ee0887ec85536d75e1e090ff7ac9)' width='1901' height='1000' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAIAAABgN0jYAAAACXBIWXMAAAsSAAALEgHS3X78AAAK70lEQVRYw6WZSXYbuRmAeZ3cLDfINjlBbpBN1v2y6SyyS%2bclrx2727baMiXKokSyyJrJmlFzVT7gJ8vU1O2n/IYhAIVC/fMAztI0LQ34vp9lGQN6P/DzokjiOAxDzw%2bCIAyDINaQTFDX9TiOQ9/neRZFUdu2evoN0Pf9M6vj2Js2nB1SqKKpmht/ecijNz%2b%2bORgwaMSgXRRFnucz0OUPE3CdVkGIPo5iqGJ3FMX7MBT09f80pVNKVVVVVhU7mUI50/oF4JHK81Lxr5Rdsl%2bfUJZ121a23S1uhtvb%2bu5erxhIUv0VN/KTLFmtVqAnBEgPqnx3VtYNpzR13TYNvW5NAzv5S88mz3N93zsYHkMYp3OoYOC6LociIE40O72nqHNabmDn2ksn8uIi9BzX87ScfR%2bugYTjOOnbd9vF8n65yd7%2b7N7ducHZoySFfRweGibyIYiRp5wwU0mUZekhS/mj%2bzSNTmB4H%2b2BMARFxocTyIZpUTZP68fXzTPZgNzyjx%2b3y9tby1n5iWPvQMi2bVgAKpzufrxY/PDm6l/v/J8/WKsVTPE9nw3b7RaMYRY9jBO5lYaDHHtxcTG7DIrV0mqWy3q1Lpd3uWXlRYlO6VboVohWZfkDMHonQ9n39VFx9mKhzEArW7rZxPt9VhRZ1SqDDQ9gDjRAjGXvoGq7WTuet7PtwNeWxzoSEMZPfAkNMID9PJ397rvgT3/5T7a6/u/i4%2bZuoX58yzfyLDvDU%2bVlmaPrrCszliljVeinelAe14sTVQa5rWUhAmQNAegZK2hOqo0oNaaUwuP1em1ZFtjsD4ftdhcGoTwSUYfafQQiXl6nF8XbG0A/Z398n/7tHxf9zWd/MU%2bv5/Wny7SslBGXbgysrbq6VpeXKgjUxlK3S3XzRc3nyrGVZSnH1Yv3K724WKj9QWWFvAsVYaStUEg6nAEYi%2bWABOjCaTZ0BrA0qIXO1oAsMmVRntKLcI2h1jO81i6q5qvDxsnWTrIKy6Tqy6ZXx9aptFDBQbmBypSKUnVI1D5WXqjXaSzGmV5kj79XRaXqTt4t2z4oWtxibTwVHx4N4B/BBmc6nsC4j3qashOyjWs9AlNx0wLiu2Q86/oeAi638W2Q3Qb5Fy/Lqw4CqnaoWk1J2Y3lMLK9GcZqGItuVL2elt1wbEx7s2cwi00vrWr6MKsH8z0wEPc/0TARcI7oOTxaf2k642%2b0T8LtbrfdblYr%2boyPg6gqq1oPun7oup6Wppn2AW1fN8z51%2btH0psNuumVYwPhSLUTAY9iGWw%2bRbDxPMAJWr0BGeheH/Zgp7yuCWDNjbP1dovFoo7Iumq1rNHi5kysQJamOlwYksZvg6Q8EoDKovdoPJRI6KRnEWeywTvFMe4Sw2WVqeO6bMNSsVd24mpwqffLJSdoH3AG%2bIAZdIRRjmUnOfpcZkWZVl3dDXy57QcGU%2btAfRjzWut30z149Gxjz774KgGw53siCmEwA/DDgrEBesll8P9QB4N5ixW8aRln74Lbv2%2bskWBrLFtCrZg7KjQc9uluvblfrTcby7YdDJeMpNH2ruU2NYIqK6DVQsfZ%2bkuNPfGZCh20l9zCzsnBT%2bEPC2ZqWRvmt24aJqprdfwG/8RkL1GRbbOsa5rqlJhImIcLWoWCVG22W9/zcNtaT4yGwIbqZOkCfAm96l6lQpMEQFSw3%2b12koBABvxmBeXB/185mZ/wXYRTQKqoHBkJR3UnmNwrMtQEeHG%2bsZ2Ntb27X/vhHk8Ciq1p50YpUyy8brX8u99qj4wYAohZ4E3opdea7fvoMevwkpW7uzsyj8%2b7xInyvmuJZuxEDsQ8PEpU6DytfioBiIgOWegFLpINQuIhoV7jqjX%2bSIY0%2bE5T2sP2Xf/g0bONPYeHKiTYIwF6o96BZL5wFHqQD9Z9lMDQaxUyEoBI8LXzpjyp/mQDRgKjNuLtBheqQUut1iEDMs9jh/ZCRMcG7r9ShfAquxNgDKJOnAlhIMQiLgi8iEhuXKAmqBOk8iJpEC79Jqq7dtDR10S9xoCxgXFwD%2blqs1mv6DZkGWXTSvCrH7pR/YH6NQTUJnAKAZIPa4%2bJvybDM9k4qIht4GDndhIkahw6Qo6k0OiYTgqr%2bvvgYl8WPc7nAQHD4McYseP6QZzmeKCs6rSr6Uesuem%2btta40aLWUbbtHjx6trXajTbiD1KTpYOl5JW4FhhPLxKAr%2bBK2o2uz3fpfZDbUSFCk/pLVylt8/Zg40gHbBhFmFQIj4cN7F3P1Rm4Dxm5DlamxsNhnzXjGEcMoNHudeh/q2nrUo3RvVTcJZEIIaM/lgEsQeoNRM0i/rKsmis7uXHT%2bS7Bx7qOg%2bgQka57qzrKa1KtWNVxcazmjirkHdLl3d1yufxyc8MHdBzQbMsfqRAYoAqviMSiQvAbFaKf/KAEMghgyuE6eDXtjYMEirsgPwYyeIovUgWn/RjNf3/z1z98TP88L%2bHQZMSj5R3watQX%2byAgnSeIsigyOsdGdE7cyyuMGGaLBCR5lvobesCPDdi0mMfO8Q5JRoEB2UEQIhnZX9UVuv%2bd9%2bYqpixVVh4Q7U8S2CNinCf5Y6eqNlEtSoQYdL7Qfm1YBS2velX3Tfvg0bONPfv8AQHgKpVAaGpcAAIYwynXALZ969EyzEBKcMxGS94UA5Itjv3ol4fvg/dhlZ1sIMoIY9RF641l2U5hVEi/0Pei99LMQt8YHz%2berb/UgPhMAkms8zY4LeWYVAjihdBVaMK9w/drO1362cIheCnfeCFA9PkYxTDoSucUH%2bJ122kJjPY%2bvb1fWZgRbu76uix0BqHtRqlzfeCgV6cSYOP4e4kAkgVBg9x6MAYtpKGvO6oaI1646bW%2bi0gxAB7JBYTEL4HK3KFUta6ZdD1woJLa7drddvx8OSwWVdX8Ck4mSL/GBnZuKEkENIC0aIUYsSRzWDoEzO104WZXtibAM%2baBiB4RUBsCMIuyk1QiyqsoJdcEdSwhqztKlvL2Xl3dVMFe58akIQ0hsMP/FmVTVhSjenrspbX9o9a0/T5vhlMFSBFSnYCpVJhTaQJOUqyYdH0oGr0ublCQfqZkMzd5s6HvDmVHzmKS%2bFF/m1y6KJOfPux%2b%2blD/89/1/bp%2bf1FfzmtrV3%2b%2bqq9v6l8%2b1x9/qT/N6/l1fXNbf/pcOx5v/Xo9UD0EuSArT3C8vSP8m1u2XntasvdO0p7mZZjhlIu6i4qGAJGUTWparur0l3n0/iK9t0gD4ziPU1276zYNkkKPiypOizivdHx52CIOKTVf9bWUKnAmGPHO5O34IhSJKUq1PYEoGCmSFGLnUDwHysAsSvI4Saoi4itJmodRhhf2oxQ34MRFQswrz0B4pnthnjqulOqlJgm9fEwHLFQ7y1mW257GcFjb5ROZnAvqKcjVC/YzC%2bLG38dj45E/BWn5xc2CrCKS/3y/f7cMg7QypfT4/4DUxOQFO9v59GX9ZaVjkySkJNdIAwuW3G7ylZJiyMXRU97jISHecdzFYjHDPZt5pu%2bsKR2yhAm9ytOSWiKOOUJqP4FpLJfsMpju/aZ70nMwV8JKXxJ7rr3bOvZufwKTouJYbXNR1UyZFJizHzp523idampMiwLfRcnvkf/PzDVeSr4lBX9iIgu8oZiAPeTslFFTKcgjvoqOSg0uK1KjsGe6ypRLhwn0jwlV9Q1yPC%2bovxVmjy4qBJInIJzmkVibCPH4i8H5zx4Gzo%2bShJl%2bupB6ekX19G7r7HePF2gdjnv%2bBzaCWi%2bQr5yGAAAAAElFTkSuQmCC' /%3e%3c/svg%3e\" width=\"1901\" alt=\"Network\" data-srcset=\"/assets/static/heu-checkin1.82a2fbd.2e35e2c967dd8ae72bbd6d3ad3bee786.png 480w, /assets/static/heu-checkin1.cbab2cf.2e35e2c967dd8ae72bbd6d3ad3bee786.png 1024w, /assets/static/heu-checkin1.eaff22a.2e35e2c967dd8ae72bbd6d3ad3bee786.png 1901w\" data-sizes=\"(max-width: 1901px) 100vw, 1901px\" data-src=\"/assets/static/heu-checkin1.eaff22a.2e35e2c967dd8ae72bbd6d3ad3bee786.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/heu-checkin1.eaff22a.2e35e2c967dd8ae72bbd6d3ad3bee786.png\" width=\"1901\" alt=\"Network\"></noscript><figcaption>Network</figcaption></figure><figure><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1901 1000' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-0de6a417156f0b67252112b29abcd96b'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-0de6a417156f0b67252112b29abcd96b)' width='1901' height='1000' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAiCAIAAABgN0jYAAAACXBIWXMAAAsSAAALEgHS3X78AAAM8UlEQVRYw7VYV3fbyBXmr8pz/kZe8ivyZFuyZKqwNzSCdFzkLiWbbPZ4rbU3Ttl4Ja3tldWLxQ4SBNgAkiBBgqLyzQxFU267zjm5uh4PLmaIe%2bf2cTWbzQ6FSqXSarW63S5GOm83TaNarWp6BWO1UjVN0zAMjM0mBtO27eFwOBgM2u12o9Ho9/t4PP0l%2bBVL3oFlWT27d6Kn663G%2bto6vl6v1/EtykPTouACu2wGJhkVFKxrUbY0Ta/Xsa2Bt2ynYZARAJl7vR7EgAB4hOSY9z4BeNO1rG6XrhpRbLZ%2bPA76/dOBw970KbDDVetlo2Vk0hkwBh4gBhsZqy671%2b/Sn8SG8ffYvO84VqdTLpc1TYNIIGJk0uIb%2bOlSqYRvVKpERRADKyk3I2ScYVebQrFcSqkNzbCqmlrWdHxb13VshFJLJRULlHItU9TaVkcrE8ArnIuqlltmixiCpsEuwDq%2bns1m2Vv8gguG0iY2AU6oZZjNMTZbLRCxp1FvGA0YT9MwqBEZbNnIotgugGFc3H7%2bg/S8zPbWlpJKpZVyTjfVUlHTdcgPtqrVGrjRde1tXjvM4bFeyOd1CligKMU2ZOp0ICFYxwRKZCdYq9W2t7ddR4XyUa5YhqT4U9XSp6BYPJ/QOcMRqASL9NUk4NdUtVgs4kv4XjObaVQqZqttdnrtdosZAFjHKpx3oVBQi0qxkFPpFhx2tVKBKvBQr9cMdnJ0xBYYAiaQsFhUXL%2bZuvXbP4QFWZgO%2b/xCTI7HRYBEkYEkibIsJhIiXjHEI3D8OEnEYrpXikscFwuFgqFQ6LvV7%2bCRcCZogoQLsN4m3ONMYZ75PJhXdL2C9wVFgUKgYcNs1qE606w2DOp%2bxH2xAIiVRLxqDc%2bOc%2bb6vf/W7y4HJZHzhQOhaETguRjHx2I8x1GMcZzPx127xl29ygUCnMfDzc1zbjc3M0PoHi/n9xPi4iIhYlkoRLbQvbEYFwxHQ8Hg6uoqnMGsN6iGobo3hfzLamW3qu9W9J1adR/Y6WTtbs62c3Y3a9v5jvnWLm93q/u2umW10x0rY1npdivV7WTZI9Du5rvtddc3X60EIpw7JPqikjcqAqNCnJdkXopTlHkIFAjxvgDP8XwkyocjfCjMB4J8lCMYAzFG6MEQIfICL7LtshCXoVlQ/v79951up2Y3ETB6tlWrHmm6iojSbhtATJrNOhABvNtpkjDebZqFbPXJt9nnz5tPv6vVdaMBJejlsoJlcI16TW82q4iCfeuOa3l5eSEQnfFG5oIxdyDm9kdjgiSIcUGKC6JMJnFZkBNCIililBN8PMGTSZLQJ5ERJbrlHMO8BKmfPXvWd/rtfuf0DDBoNQtFhCTiI2XqRypMCIHJcU4RP3s9B46KmJHbP6zlFMdsOgOSP84uAvLJcHg27P/NtbKy4vcHQ16v1%2bdbXFz0eb1EACnO4SwF/B%2bXpBFGcd4Awpk0Jn4E4yMERPg4bIkI0O8j5dEP900jVyyq8E8qAzErxCJEK8dxWNi1rDZimFavVUyzXKupGmKrdfY%2b0NNwvoYAy55gxOPzxaIRADwPDijLsgBbEIRkMpFIyAyj0Ygo4qzluBwfEz%2bDyYQcE98JkM/nNRL%2bkYeyxRJyS1lRFBARcyAEYi4TAKedzedLBwfFV6/L2zulV68r%2bQJi1sB5D3rw4IH9ZyKALxgOhsI4X5x6DChIOGZIIQKl%2bBglOQEiR99O0j%2bDEZjQuQA06uGwi7VqqqRq4BgRvT0BLHueDgYZpZB9%2biz3/fPc2lp%2b9bvq3r5pWQbNJhOASNppm/dHJuT3eBZgQIvQhA%2b%2bC9YlArACeYw0ohLrEi/SL6D8DgGIB0wAnBiiIbISHLFaOVFVEuIRDTUKbAJ5sAwFVSabRc1wZveGnc7Q6qDeGp6dfc6EfKEoPCAQCHi8nlgsKlFWOBIM%2bUQyObaJcDgMFyB6AGsfM5oEyBOYlOXYRQGIs6oFCMB8gGUlJHpkOigEGkC%2bgwml02lkibNfgAkBvCH4AHTgnV9YROIhIYX6Y0IUExjHKJIRaSouShfoFIm1TXjwuRNLYwGQd6CBUqlQq6XLZVIF4cgHE4A1kAECZDKZLxJgxR8II4kFggQhAAdL4YWV6Zkl9/ztmWu3Z90jvDa3dG3uxoz75oz7HZHirVn33WtzD6dnPyMA04Bpoi7IQYBU6gQZGI6BOgJOzEpGxCJw9T8IEPJ7vcQFFhZCwQB8IMkLd2fdN%2b/effTw4QOGDx7cu0/gHsUHF%2bHhw4e3bt26755PxJnxE0hcNCFoAE6s66pRz4Bb/LESDUDLCwLQCXzgS01oxRMIL0IA6sXhYJAIIIg3pqaPUynotUm7nFFR/7GKH4aLn1pfX7s5fTUpy58RAGWPomTLWiqbQwBFNihCA%2bAVZsNCI%2buKvlQDy16SB/z%2bQDAcQeAmwTse429enc0oikN7AMbipwCfpAKsJy9PydKFyItMjFLiyZMnOAK4rFIstpqNulFAHkASgAmxH%2b%2bfA8sDX6aB5ZWVQCAcIQ4QDASCGDkR1YJ4%2b%2bpsVlHG/H3yZ4bDhtXDZGNj44%2bXp5PxxDikIpRG%2bTjS%2bbePH8M8mAkVChlNPUAFncsSYH3SuJcifdlgAAFgV19kQiEYz/z8vNvt9ngWmQn98fKVVCZD1vSd4eAUreyHeHZ6ihIhp7cg4k/razeuTF0nhvNxE0L5C1%2bFCRlmXtOrhaKSpU7MehTwjbNn5caXmdCfVlYW/UEUQlwshvNH9EfRluCFpVl38s6dew8e3Ll/n%2bESHW/fu7d07/6YeBcO/fDBvYcPkjdu3p2bT37aiVFCIAop%2bYy29UPqx43Uv39Ira2l0um3FBCIyM1BpYKckM5kINOvEWDYpxrw%2bsOwfqRYXkQdKkVRrnHCyqWpG9Mz1y9duX55ahLlS1cSly5QkpcI3p6aWb48TWrYCQy/KyWcXFFHHlBgQj%2buHn/z5PirvxZfrBWKaiEPZ4A/l3K5PLCQL6CRY6r4ZQ0M/kIEgA9ABahHPUCUEsgDOEdRTIridUkaIxIZKHBSTCbpDJPIZZIkfyIK9ZEHarSh0dRG6ofKv76u1naM%2bn61sqNrW/Xabr22V6/u1qo7qrZTUrea7fTAyfd7uYFTGPTzTj9/eqoML2DhbKhb5qORD8yTOsgT9noj12YFjo/LCVgUSgk5CbdMMCQ5DtW0nEDrOCZOonwRLphQv1/RNWSsAjLWxnqnWHDOhk6/h%2b6yUa/1el209QOnB2fYV%2bpHqoER5Roq7narWdHLdbrGtjtA9PTdbsfuWkbX3j84pInMF0B/KHq9yenp6263iE4kfl7gjKqeBGMPxTUt5EaUcRE0WvmpWujpU2cwQDFJ%2bn6EzzdvUFK0WlaP3LhY6G8dZ4BmF9HC7jlvy61MxTout9C%2bgVir1YHw88FwSDLFYABl9h1SdzT7zvHh8SiMimHU%2bhJpYUQJDQGqiQvWLL6bcAJ1lXevJIrx96x/wge4Z8%2bfo5iurW8oGxuF/7xQ19a115uljQ39501zd097%2bdp%2be6L8uN4%2bOLSO3m6/2D7a2N39cdvY2Suubxg7u%2bWXr%2bo/b9qFQo82DOwGDXG31u1uHu67VpaXA1EUmQmBdrFkpDkITu2bXxDnFgT3nHBlSpieETxe4eqsMOsWrs4Il6fIOHONvJ2%2bKnh9dO%2bHAsTR4z/75z97ubzx93%2bU19bL/3nR3d2zd/fZ2H6zBcG6O3v1n17Zu3ud7d3Mi83c2mZh7Y29d2BtbTd%2bemW%2b/tne2u4dHFKrG8GpMzB77RO96Fp%2b9CgS49D7RXgxyosxNgoSMBrj0UaiX49EYhEyGSMoHEE2x4i2nhc/RPwINPD06VN8slYuF1IpNZslFymptJJK59%2beaAhA6Uz%2b5ARjKZtV0mk9n0eSa1eryHxWvdFpGFajYZ3fCI6hTS%2b5%2bnbPdefuvVAoJPJRgeejsVgoEo3GuGAk6g9F/WHwzwnEsAQ6ok2mKEwgP0H/ANGUootYXV11SKdrwXbrZstsWTCCaq3WME1q0ATsCSftdO3u%2bQUliOw6rkM5HgOsqNVu6RXddfPuo0V/4LoURGgJRfm5ABeKCbO%2b6KWF8KX5cDCGtjgpj/IrHd%2bPNufEj7Y4ySREZy0luRNSy3sn%2bZMsajitSC8kUEJjgsiE2mFUMlJgXQ69zHr/7AH0GtPA3uPjY9edO0uhUBCnjo4%2bFo3y%2bBeNYBS4GBBPEQrRc/jwcUz8EPDK7/c/fvwYZ8yKfmQytUQuGxkg9SoUiH5oKcoAfLMOAWvGV9njC21ICzrKEKRw19LSEr4RiYQZhNDb%2bEl3BiL6Y2S3hfl5D57JtQtKVn8wGGSvJsFPtnjYerSm4XOADKBAAHbff/Z/ABcqp4ODg8NPw%2bTbo6Ojly9fbm5uYnL4qwGfwJkNJ%2bC9avzDgvejKz%2b65r%2bQKjzVgMzXLAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e\" width=\"1901\" alt=\"doAction - Form Data\" data-srcset=\"/assets/static/heu-checkin2.82a2fbd.a282637541e4f36d4a8e50f3a438dbec.png 480w, /assets/static/heu-checkin2.cbab2cf.a282637541e4f36d4a8e50f3a438dbec.png 1024w, /assets/static/heu-checkin2.eaff22a.a282637541e4f36d4a8e50f3a438dbec.png 1901w\" data-sizes=\"(max-width: 1901px) 100vw, 1901px\" data-src=\"/assets/static/heu-checkin2.eaff22a.a282637541e4f36d4a8e50f3a438dbec.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/heu-checkin2.eaff22a.a282637541e4f36d4a8e50f3a438dbec.png\" width=\"1901\" alt=\"doAction - Form Data\"></noscript><figcaption>doAction - Form Data</figcaption></figure></p>\n<h2 id=\"调试\"><a href=\"#%E8%B0%83%E8%AF%95\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>调试</h2>\n<p>表单数据有了，开始调试 Python 。</p>\n<h3 id=\"邮件提醒\"><a href=\"#%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>邮件提醒</h3>\n<p>源代码最后的发送邮件部分需要自行引用发送邮件的 <code>.py</code> 文件，但是谷歌找到的好几个 <code>sendmail.py</code> 补上去之后都有奇怪的报错，比如 <code>if</code> 条件右括号报语法错误，我明明是直接复制的啊 QaQ ，看了好几遍也不应该有错啊（后来发觉可能是 Python 版本问题）。最终我索性直接搜 Python SMTP 的用法，找了一段代码补上去。</p>\n<p>在 Linux 下试运行的时候发现打卡段没问题，但是后面邮件发送这段报错：</p>\n<pre class=\"language-powershell line-numbers\"><code class=\"language-powershell\">Traceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"checkin.py\"</span><span class=\"token punctuation\">,</span> line 151<span class=\"token punctuation\">,</span> in &lt;module>\n    smtpObj<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>mail_host<span class=\"token punctuation\">,</span> 25<span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 25 为 SMTP 端口号</span>\n  File <span class=\"token string\">\"/usr/lib64/python3.6/smtplib.py\"</span><span class=\"token punctuation\">,</span> line 336<span class=\"token punctuation\">,</span> in connect\n    self<span class=\"token punctuation\">.</span>sock = self<span class=\"token punctuation\">.</span>_get_socket<span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>timeout<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"/usr/lib64/python3.6/smtplib.py\"</span><span class=\"token punctuation\">,</span> line 307<span class=\"token punctuation\">,</span> in _get_socket\n    self<span class=\"token punctuation\">.</span>source_address<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"/usr/lib64/python3.6/socket.py\"</span><span class=\"token punctuation\">,</span> line 724<span class=\"token punctuation\">,</span> in create_connection\n    raise err\n  File <span class=\"token string\">\"/usr/lib64/python3.6/socket.py\"</span><span class=\"token punctuation\">,</span> line 713<span class=\"token punctuation\">,</span> in create_connection\n    sock<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>sa<span class=\"token punctuation\">)</span>\nTimeoutError: <span class=\"token namespace\">[Errno 110]</span> Connection timed out<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>搜索了一圈发现 Linux 下 SMTP 发信加密程度要求更高，所以得加密发信，将原来的发信替换为 SSL 加密发信：</p>\n<pre class=\"language-python line-numbers\"><code class=\"language-python\">smtpObj <span class=\"token operator\">=</span> smtplib<span class=\"token punctuation\">.</span>SMTP_SSL<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \nsmtpObj<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>mail_host<span class=\"token punctuation\">,</span> <span class=\"token number\">465</span><span class=\"token punctuation\">)</span>      <span class=\"token comment\"># 一般加密发信 smtp 端口号为 465</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span></span></code></pre>\n<p>在 3.7 版本以上的 Python 中需要此脚本时必须使用 <code>smtpObj = smtplib.SMTP_SSL(mail_host)</code> ，否则邮件发信会报错 ValueError 如下：</p>\n<pre class=\"language-powershell line-numbers\"><code class=\"language-powershell\">Traceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"/home/Project/Python/HEUCheckin-2018041015.py\"</span><span class=\"token punctuation\">,</span> line 170<span class=\"token punctuation\">,</span> in &lt;module>\n    smtpObj<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>mail_host<span class=\"token punctuation\">,</span> 465<span class=\"token punctuation\">)</span>       <span class=\"token comment\"># 加密时 SMTP 端口号为 465</span>\n  File <span class=\"token string\">\"/usr/local/Python3.8.2/lib/python3.8/smtplib.py\"</span><span class=\"token punctuation\">,</span> line 339<span class=\"token punctuation\">,</span> in connect\n    self<span class=\"token punctuation\">.</span>sock = self<span class=\"token punctuation\">.</span>_get_socket<span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>timeout<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"/usr/local/Python3.8.2/lib/python3.8/smtplib.py\"</span><span class=\"token punctuation\">,</span> line 1042<span class=\"token punctuation\">,</span> in _get_socket\n    new_socket = self<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>wrap_socket<span class=\"token punctuation\">(</span>new_socket<span class=\"token punctuation\">,</span>\n  File <span class=\"token string\">\"/usr/local/Python3.8.2/lib/python3.8/ssl.py\"</span><span class=\"token punctuation\">,</span> line 500<span class=\"token punctuation\">,</span> in wrap_socket\n    <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>sslsocket_class<span class=\"token punctuation\">.</span>_create<span class=\"token punctuation\">(</span>\n  File <span class=\"token string\">\"/usr/local/Python3.8.2/lib/python3.8/ssl.py\"</span><span class=\"token punctuation\">,</span> line 1031<span class=\"token punctuation\">,</span> in _create\n    self<span class=\"token punctuation\">.</span>_sslobj = self<span class=\"token punctuation\">.</span>_context<span class=\"token punctuation\">.</span>_wrap_socket<span class=\"token punctuation\">(</span>\nValueError: server_hostname cannot be an empty string or <span class=\"token function\">start</span> with a leading dot<span class=\"token punctuation\">.</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"关闭代理\"><a href=\"#%E5%85%B3%E9%97%AD%E4%BB%A3%E7%90%86\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>关闭代理</h3>\n<p>本地调试的时候，由于我平时习惯开 Clash 代理挂着，没注意这个，结果就报错了，信息如下：</p>\n<details><summary><strong>Python Traceback</strong></summary><br />\n<pre class=\"language-powershell line-numbers\"><code class=\"language-powershell\">Traceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\urllib3\\connectionpool.py\"</span><span class=\"token punctuation\">,</span> line 665<span class=\"token punctuation\">,</span> in urlopen\n    httplib_response = self<span class=\"token punctuation\">.</span>_make_request<span class=\"token punctuation\">(</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\urllib3\\connectionpool.py\"</span><span class=\"token punctuation\">,</span> line 421<span class=\"token punctuation\">,</span> in _make_request\n    six<span class=\"token punctuation\">.</span>raise_from<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> None<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"&lt;string>\"</span><span class=\"token punctuation\">,</span> line 3<span class=\"token punctuation\">,</span> in raise_from\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\urllib3\\connectionpool.py\"</span><span class=\"token punctuation\">,</span> line 416<span class=\"token punctuation\">,</span> in _make_request\n    httplib_response = conn<span class=\"token punctuation\">.</span>getresponse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\http\\client.py\"</span><span class=\"token punctuation\">,</span> line 1322<span class=\"token punctuation\">,</span> in getresponse\n    response<span class=\"token punctuation\">.</span><span class=\"token keyword\">begin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\http\\client.py\"</span><span class=\"token punctuation\">,</span> line 303<span class=\"token punctuation\">,</span> in <span class=\"token keyword\">begin</span>\n    version<span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">,</span> reason = self<span class=\"token punctuation\">.</span>_read_status<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\http\\client.py\"</span><span class=\"token punctuation\">,</span> line 272<span class=\"token punctuation\">,</span> in _read_status\n    raise RemoteDisconnected<span class=\"token punctuation\">(</span><span class=\"token string\">\"Remote end closed connection without\"</span>\nhttp<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>RemoteDisconnected: Remote <span class=\"token keyword\">end</span> closed connection without response\n\nDuring handling of the above exception<span class=\"token punctuation\">,</span> another exception occurred:\n\nTraceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\adapters.py\"</span><span class=\"token punctuation\">,</span> line 439<span class=\"token punctuation\">,</span> in send\n    resp = conn<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\urllib3\\connectionpool.py\"</span><span class=\"token punctuation\">,</span> line 719<span class=\"token punctuation\">,</span> in urlopen\n    retries = retries<span class=\"token punctuation\">.</span>increment<span class=\"token punctuation\">(</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\urllib3\\util\\retry.py\"</span><span class=\"token punctuation\">,</span> line 436<span class=\"token punctuation\">,</span> in increment\n    raise MaxRetryError<span class=\"token punctuation\">(</span>_pool<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> error or ResponseError<span class=\"token punctuation\">(</span>cause<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nurllib3<span class=\"token punctuation\">.</span>exceptions<span class=\"token punctuation\">.</span>MaxRetryError: HTTPConnectionPool<span class=\"token punctuation\">(</span>host=<span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">,</span> port=7890<span class=\"token punctuation\">)</span>: Max retries exceeded with url: http:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>cas<span class=\"token punctuation\">.</span>hrbeu<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>cas<span class=\"token operator\">/</span>login?service=http<span class=\"token operator\">%</span>3A<span class=\"token operator\">%</span>2F<span class=\"token operator\">%</span>2Fjkgc<span class=\"token punctuation\">.</span>hrbeu<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">%</span>2Finfoplus<span class=\"token operator\">%</span>2Flogin<span class=\"token operator\">%</span>3FretUrl<span class=\"token operator\">%</span>3Dhttp<span class=\"token operator\">%</span>253A<span class=\"token operator\">%</span>252F<span class=\"token operator\">%</span>252Fjkgc<span class=\"token punctuation\">.</span>hrbeu<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">%</span>252Finfoplus<span class=\"token operator\">%</span>252Fform<span class=\"token operator\">%</span>252FJSXNYQSBtest<span class=\"token operator\">%</span>252Fstart<span class=\"token operator\">%</span>253Fticket<span class=\"token operator\">%</span>253DST<span class=\"token operator\">-</span>3779417<span class=\"token operator\">-</span>6SDr7iRPSkJxSd3MFyNd<span class=\"token operator\">-</span>cas01<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>org <span class=\"token punctuation\">(</span>Caused by ProxyError<span class=\"token punctuation\">(</span><span class=\"token string\">'Cannot connect to proxy.'</span><span class=\"token punctuation\">,</span> RemoteDisconnected<span class=\"token punctuation\">(</span><span class=\"token string\">'Remote end closed connection without response'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nDuring handling of the above exception<span class=\"token punctuation\">,</span> another exception occurred:\n\nTraceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>:\n  File <span class=\"token string\">\"d:/workshop/PythonProject/CheckIn/checkin.py\"</span><span class=\"token punctuation\">,</span> line 61<span class=\"token punctuation\">,</span> in &lt;module>\n    response302 = sesh<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> <span class=\"token keyword\">data</span>=user_form<span class=\"token punctuation\">,</span> headers=headers<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\sessions.py\"</span><span class=\"token punctuation\">,</span> line 578<span class=\"token punctuation\">,</span> in post\n    <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">(</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> <span class=\"token keyword\">data</span>=<span class=\"token keyword\">data</span><span class=\"token punctuation\">,</span> json=json<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>kwargs<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\sessions.py\"</span><span class=\"token punctuation\">,</span> line 530<span class=\"token punctuation\">,</span> in request\n    resp = self<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>prep<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>send_kwargs<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\sessions.py\"</span><span class=\"token punctuation\">,</span> line 665<span class=\"token punctuation\">,</span> in send\n    history = <span class=\"token namespace\">[resp for resp in gen]</span> <span class=\"token keyword\">if</span> allow_redirects <span class=\"token keyword\">else</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\sessions.py\"</span><span class=\"token punctuation\">,</span> line 665<span class=\"token punctuation\">,</span> in &lt;listcomp>\n    history = <span class=\"token namespace\">[resp for resp in gen]</span> <span class=\"token keyword\">if</span> allow_redirects <span class=\"token keyword\">else</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\sessions.py\"</span><span class=\"token punctuation\">,</span> line 237<span class=\"token punctuation\">,</span> in resolve_redirects\n    resp = self<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\sessions.py\"</span><span class=\"token punctuation\">,</span> line 643<span class=\"token punctuation\">,</span> in send\n    r = adapter<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>kwargs<span class=\"token punctuation\">)</span>\n  File <span class=\"token string\">\"D:\\Python\\Python38-64\\lib\\site-packages\\requests\\adapters.py\"</span><span class=\"token punctuation\">,</span> line 510<span class=\"token punctuation\">,</span> in send\n    raise ProxyError<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> request=request<span class=\"token punctuation\">)</span>\nrequests<span class=\"token punctuation\">.</span>exceptions<span class=\"token punctuation\">.</span>ProxyError: HTTPConnectionPool<span class=\"token punctuation\">(</span>host=<span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">,</span> port=7890<span class=\"token punctuation\">)</span>: Max retries exceeded with url: http:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>cas<span class=\"token punctuation\">.</span>hrbeu<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>cas<span class=\"token operator\">/</span>login?service=http<span class=\"token operator\">%</span>3A<span class=\"token operator\">%</span>2F<span class=\"token operator\">%</span>2Fjkgc<span class=\"token punctuation\">.</span>hrbeu<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">%</span>2Finfoplus<span class=\"token operator\">%</span>2Flogin<span class=\"token operator\">%</span>3FretUrl<span class=\"token operator\">%</span>3Dhttp<span class=\"token operator\">%</span>253A<span class=\"token operator\">%</span>252F<span class=\"token operator\">%</span>252Fjkgc<span class=\"token punctuation\">.</span>hrbeu<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">%</span>252Finfoplus<span class=\"token operator\">%</span>252Fform<span class=\"token operator\">%</span>252FJSXNYQSBtest<span class=\"token operator\">%</span>252Fstart<span class=\"token operator\">%</span>253Fticket<span class=\"token operator\">%</span>253DST<span class=\"token operator\">-</span>3779417<span class=\"token operator\">-</span>6SDr7iRPSkJxSd3MFyNd<span class=\"token operator\">-</span>cas01<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>org <span class=\"token punctuation\">(</span>Caused by ProxyError<span class=\"token punctuation\">(</span><span class=\"token string\">'Cannot connect to proxy.'</span><span class=\"token punctuation\">,</span> RemoteDisconnected<span class=\"token punctuation\">(</span><span class=\"token string\">'Remote end closed connection without response'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</details><br />\n<p>报错一大堆没怎么看懂，<code>ProxyError</code> 看来应该是代理问题，可能和主机的网络设置有关系，没有深究原因，所以解决方案就是 <strong>关掉代理</strong> ！</p>\n<blockquote>\n<p>尝试了在运行前用 <code>export</code> 或者 <code>set</code> 命令设置 <code>http_proxy</code> <code>https_proxy</code> 代理，也一样无法使用。</p>\n</blockquote>\n<h3 id=\"结果判定\"><a href=\"#%E7%BB%93%E6%9E%9C%E5%88%A4%E5%AE%9A\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>结果判定</h3>\n<p>调试时还发现个问题，原代码打卡出错的判定有缺陷，只报 Python 脚本出 Exception 时的错，而提交表单时可能成功提交，但是返回的不是打卡成功，而是打卡失败。那么如何判断打卡提交正常但是打卡失败呢，这里关注返回的数据 <code>response_end</code> ，用 requests 库转换成 text 后的 <code>response_end.text</code> 缩进一下长这个样子：</p>\n<pre class=\"language-json line-numbers\"><code class=\"language-json\"># 成功时\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errno\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"ecode\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"SUCCEED\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"entities\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"stepId\"</span><span class=\"token operator\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"办结\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"code\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"autoStep1\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Auto\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"flowStepId\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"executorSelection\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"posts\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"users\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"parallel\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"hasInstantNotification\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"hasCarbonCopy\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"entryId\"</span><span class=\"token operator\">:</span><span class=\"token number\">2797847</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"entryStatus\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"entryRelease\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n# 失败时\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"errno\"</span><span class=\"token operator\">:</span><span class=\"token number\">22001</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"ecode\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"EVENT_CANCELLED\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"error\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"发生异常\\n\\njava.lang.reflect.InvocationTargetException\\n\\tat sun.reflect.GeneratedMethodAccessor457.invoke(Unknown Source)\\n\\t...\\n\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"entities\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>可以看到返回的字段中 <code>errno</code> 为 <code>0</code> 代表成功提交，剩下的 <code>ecode</code> 显示 <code>str</code> 型的状态，<code>error</code> 只有出现错误时才有，包含了所有的错误信息，这个错误是在学校服务器上报的，不是本地脚本的问题。<code>entities</code> 包含成功提交后的一些数据。那么这就用 <code>errno</code> 来判定远程提交后返回是否成功。先使用 <code>json.loads()</code> 将其转换为 JSON 格式，注意在返回的数据中 <code>errno</code> 字段为 <code>int</code> 类型，<code>entities</code> 字段为 <code>list</code> 类型，发信的 <code>msg</code> 要用 <code>str()</code> 转换这两个数据。</p>\n<p>实现代码如下：</p>\n<pre class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># ......</span>\n\n    response_end <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>submit_url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>submit_form<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span>\n    resJson <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>response_end<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form url: '</span><span class=\"token punctuation\">,</span> form_response<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># print('Form status: ', response_end.text)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form Status: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form stJson: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 获取表单返回 Json 数据所有 key 用这个</span>\n    <span class=\"token comment\"># print('Form stJsonkey: ', resJson.keys())</span>\n\n    <span class=\"token comment\"># 加入远程提交返回结果判断</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'errno'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form Succeed: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        title <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'打卡成功 &lt;</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>submit_form<span class=\"token punctuation\">[</span><span class=\"token string\">\"stepId\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">>'</span></span>\n        msg <span class=\"token operator\">=</span> <span class=\"token string\">'\\t表单地址: '</span> <span class=\"token operator\">+</span> form_response<span class=\"token punctuation\">.</span>url <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\t表单状态: \\n\\t\\terrno：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'errno'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tecode：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tentities：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'entities'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\n\\t完整返回：'</span> <span class=\"token operator\">+</span> response_end<span class=\"token punctuation\">.</span>text\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form Error: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        title <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'打卡失败！校网出错'</span></span>\n        msg <span class=\"token operator\">=</span> <span class=\"token string\">'\\t表单地址: '</span> <span class=\"token operator\">+</span> form_response<span class=\"token punctuation\">.</span>url <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\t错误信息: \\n\\t\\terrno：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'errno'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tecode：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tentities：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'entities'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\n\\t完整返回：'</span> <span class=\"token operator\">+</span> response_end<span class=\"token punctuation\">.</span>text\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n:.:.:.:.: Except return :.:.:.:.:'</span><span class=\"token punctuation\">)</span>\n    err <span class=\"token operator\">=</span> traceback<span class=\"token punctuation\">.</span>format_exc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Python Error: \\n'</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    title <span class=\"token operator\">=</span> <span class=\"token string\">'打卡失败！脚本出错'</span>\n    msg <span class=\"token operator\">=</span> <span class=\"token string\">'\\t脚本报错: \\n\\n\\t'</span> <span class=\"token operator\">+</span> err<span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>好啦，现在就差不多完美了，唯一美中不足的就是没有加入 <code>retry</code> 的功能，还不了解这个怎么实现，有空可以试试。</p>\n<h2 id=\"完工\"><a href=\"#%E5%AE%8C%E5%B7%A5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>完工</h2>\n<details><summary><strong>修补完整的 auto-checkin.py</strong></summary><br />\n<pre class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python3</span>\n<span class=\"token comment\"># -*- coding: UTF-8 -*-</span>\n\n<span class=\"token triple-quoted-string string\">\"\"\"\n平安行动自动打卡\n\nCreated on 2020-04-13 20:20\n@author: ZhangJiawei &amp; Monst.x\n\"\"\"</span>\n\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> lxml<span class=\"token punctuation\">.</span>html\n<span class=\"token keyword\">import</span> re\n<span class=\"token keyword\">import</span> json\n<span class=\"token keyword\">import</span> random\n<span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">import</span> smtplib\n<span class=\"token keyword\">import</span> traceback\n\nheaders <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Accept\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Accept-Encoding\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"gzip, deflate, br\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Accept-Language\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"zh-CN\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Cache-Control\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"max-age=0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Connection\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"keep-alive\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/x-www-form-urlencoded\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Cookie\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"MESSAGE_TICKET=%7B%22times%22%3A0%7D; \"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Host\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cas.hrbeu.edu.cn\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Referer\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"https://cas.hrbeu.edu.cn/cas/login?service=http%3A%2F%2Fjkgc.hrbeu.edu.cn%2Finfoplus%2Flogin%3FretUrl%3Dhttp%253A%252F%252Fjkgc.hrbeu.edu.cn%252Finfoplus%252Fform%252FJSXNYQSBtest%252Fstart\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Upgrade-Insecure-Requests\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"User-Agent\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362\"</span>\n<span class=\"token punctuation\">}</span>\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"username\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"studentNumber\"</span><span class=\"token punctuation\">,</span>                <span class=\"token comment\"># 学号</span>\n    <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"password\"</span>                      <span class=\"token comment\"># 教务处密码</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">findStr</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> source<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\ntitle <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\nmsg <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">#get</span>\n    url_login <span class=\"token operator\">=</span> <span class=\"token string\">'https://cas.hrbeu.edu.cn/cas/login?service=http%3A%2F%2Fjkgc.hrbeu.edu.cn%2Finfoplus%2Fform%2FJSXNYQSBtest%2Fstart'</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Begin to login ...\"</span><span class=\"token punctuation\">)</span>\n    sesh <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    req <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url_login<span class=\"token punctuation\">)</span>\n    html_content <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>text\n\n    <span class=\"token comment\">#post</span>\n    login_html <span class=\"token operator\">=</span> lxml<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span>html_content<span class=\"token punctuation\">)</span>\n    hidden_inputs<span class=\"token operator\">=</span>login_html<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">r'//div[@id=\"main\"]//input[@type=\"hidden\"]'</span><span class=\"token punctuation\">)</span>\n    user_form <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">.</span>attrib<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> x<span class=\"token punctuation\">.</span>attrib<span class=\"token punctuation\">[</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> hidden_inputs<span class=\"token punctuation\">}</span>\n\n    user_form<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">]</span>\n    user_form<span class=\"token punctuation\">[</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">]</span>\n    user_form<span class=\"token punctuation\">[</span><span class=\"token string\">\"captcha\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n    user_form<span class=\"token punctuation\">[</span><span class=\"token string\">\"submit\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string\">'登 录'</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Cookie'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Cookie'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> req<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Set-cookie'</span><span class=\"token punctuation\">]</span>\n\n    req<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'https://cas.hrbeu.edu.cn/cas/login;jsessionid=</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"JSESSIONID\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">?service=http%3A%2F%2Fjkgc.hrbeu.edu.cn%2Finfoplus%2Fform%2FJSXNYQSBtest%2Fstart'</span></span>\n    response302 <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>user_form<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span>\n    casRes <span class=\"token operator\">=</span> response302<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"CAS response header\"</span><span class=\"token punctuation\">,</span> findStr<span class=\"token punctuation\">(</span>casRes<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Set-Cookie'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'CASTGC'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#get</span>\n    jkgc_response <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>response302<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#post</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Accept'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*/*'</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Cookie'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> jkgc_response<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Cookie'</span><span class=\"token punctuation\">]</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Host'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'jkgc.hrbeu.edu.cn'</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Referer'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> jkgc_response<span class=\"token punctuation\">.</span>url\n    jkgc_html <span class=\"token operator\">=</span> lxml<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span>jkgc_response<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n    csrfToken <span class=\"token operator\">=</span> jkgc_html<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">r'//meta[@itemscope=\"csrfToken\"]'</span><span class=\"token punctuation\">)</span>\n    csrfToken <span class=\"token operator\">=</span> csrfToken<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>attrib<span class=\"token punctuation\">[</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">]</span>\n    jkgc_form <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">'idc'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'JSXNYQSBtest'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'release'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'csrfToken'</span><span class=\"token punctuation\">:</span> csrfToken<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'formData'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'_VAR_URL'</span><span class=\"token punctuation\">:</span> jkgc_response<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'_VAR_URL_Attr'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">'ticket'</span><span class=\"token punctuation\">:</span> re<span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">(</span><span class=\"token string\">r'.*ticket=(.*)'</span><span class=\"token punctuation\">,</span> jkgc_response<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>group<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    jkgc_form<span class=\"token punctuation\">[</span><span class=\"token string\">'formData'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>jkgc_form<span class=\"token punctuation\">[</span><span class=\"token string\">'formData'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    jkgc_url <span class=\"token operator\">=</span> <span class=\"token string\">'http://jkgc.hrbeu.edu.cn/infoplus/interface/start'</span>\n    response3 <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>jkgc_url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>jkgc_form<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#get</span>\n    form_url <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>response3<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'entities'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    form_response <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>form_url<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#post</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Accept'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'application/json, text/javascript, */*; q=0.01'</span>\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Referer'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> form_url\n    headers<span class=\"token punctuation\">[</span><span class=\"token string\">'X-Requested-With'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'XMLHttpRequest'</span>\n    submit_url <span class=\"token operator\">=</span> <span class=\"token string\">'http://jkgc.hrbeu.edu.cn/infoplus/interface/doAction'</span>\n\n    submit_html <span class=\"token operator\">=</span> lxml<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span>form_response<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n    csrfToken2 <span class=\"token operator\">=</span> submit_html<span class=\"token punctuation\">.</span>xpath<span class=\"token punctuation\">(</span><span class=\"token string\">r'//meta[@itemscope=\"csrfToken\"]'</span><span class=\"token punctuation\">)</span>\n    csrfToken2 <span class=\"token operator\">=</span> csrfToken2<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>attrib<span class=\"token punctuation\">[</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">]</span>\n\n    submit_form <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">'actionId'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\"># boundFields 修改位置</span>\n        <span class=\"token string\">'boundFields'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'fieldCXXXdqszdjtx,fieldCXXXjtgjbc,...'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'csrfToken'</span><span class=\"token punctuation\">:</span> csrfToken2<span class=\"token punctuation\">,</span>\n        <span class=\"token comment\"># formData 修改位置</span>\n        <span class=\"token string\">'formData'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">r'{\"_VAR_EXECUTE_INDEP_ORGANIZE_Name\":\"学院\",\"_VAR_ACTION_INDEP_ORGANIZES_Codes\":\"xxxxx\",...}'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'lang'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'zh'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'nextUsers'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'{}'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'rand'</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'remark'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'stepId'</span><span class=\"token punctuation\">:</span> re<span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">(</span><span class=\"token string\">r'.*form/(\\d*?)/'</span><span class=\"token punctuation\">,</span>form_response<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>group<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'timestamp'</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    response_end <span class=\"token operator\">=</span> sesh<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>submit_url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>submit_form<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span>\n    resJson <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>response_end<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">## 表单填写完成，返回结果</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form url: '</span><span class=\"token punctuation\">,</span> form_response<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># print('Form status: ', response_end.text)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form Status: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form stJson: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 获取表单返回 Json 数据所有 key 用这个</span>\n    <span class=\"token comment\"># print('Form stJsonkey: ', resJson.keys())</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'errno'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form Succeed: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        title <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'打卡成功 &lt;</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>submit_form<span class=\"token punctuation\">[</span><span class=\"token string\">\"stepId\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">>'</span></span>\n        msg <span class=\"token operator\">=</span> <span class=\"token string\">'\\t表单地址: '</span> <span class=\"token operator\">+</span> form_response<span class=\"token punctuation\">.</span>url <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\t表单状态: \\n\\t\\terrno：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'errno'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tecode：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tentities：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'entities'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\n\\t完整返回：'</span> <span class=\"token operator\">+</span> response_end<span class=\"token punctuation\">.</span>text\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Form Error: '</span><span class=\"token punctuation\">,</span> resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        title <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'打卡失败！校网出错'</span></span>\n        msg <span class=\"token operator\">=</span> <span class=\"token string\">'\\t表单地址: '</span> <span class=\"token operator\">+</span> form_response<span class=\"token punctuation\">.</span>url <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\t错误信息: \\n\\t\\terrno：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'errno'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tecode：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'ecode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t\\tentities：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>resJson<span class=\"token punctuation\">[</span><span class=\"token string\">'entities'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\n\\n\\t完整返回：'</span> <span class=\"token operator\">+</span> response_end<span class=\"token punctuation\">.</span>text\n<span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n:.:.:.:.: Except return :.:.:.:.:'</span><span class=\"token punctuation\">)</span>\n    err <span class=\"token operator\">=</span> traceback<span class=\"token punctuation\">.</span>format_exc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Python Error: \\n'</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    title <span class=\"token operator\">=</span> <span class=\"token string\">'打卡失败！脚本出错'</span>\n    msg <span class=\"token operator\">=</span> <span class=\"token string\">'\\t脚本报错: \\n\\n\\t'</span> <span class=\"token operator\">+</span> err\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n:.:.:.:.: Finally :.:.:.:.:'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">## 发送邮件</span>\n    <span class=\"token comment\"># import sendmail     ## 这个是普通.py文件，不是Python库</span>\n    <span class=\"token comment\"># sendmail.sendmail(title, msg)</span>\n\n    <span class=\"token keyword\">from</span> email<span class=\"token punctuation\">.</span>mime<span class=\"token punctuation\">.</span>text <span class=\"token keyword\">import</span> MIMEText\n    <span class=\"token keyword\">from</span> email<span class=\"token punctuation\">.</span>header <span class=\"token keyword\">import</span> Header\n \n    <span class=\"token comment\"># 第三方 SMTP 服务</span>\n    mail_host<span class=\"token operator\">=</span><span class=\"token string\">\"smtp.exmail.qq.com\"</span>                 <span class=\"token comment\"># 设置 smtp 服务器</span>\n    mail_user<span class=\"token operator\">=</span><span class=\"token string\">\"example@example.com\"</span>                <span class=\"token comment\"># smtp 发信邮箱用户名</span>\n    mail_pass<span class=\"token operator\">=</span><span class=\"token string\">\"emailpassword\"</span>                      <span class=\"token comment\"># smtp 发信邮箱密码</span>\n    sender <span class=\"token operator\">=</span> <span class=\"token string\">'1@example.com'</span>                       <span class=\"token comment\"># 发信邮箱显示</span>\n    receivers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'2@example.com'</span><span class=\"token punctuation\">]</span>                  <span class=\"token comment\"># 修改为收件人邮箱，多邮箱以数组形式写</span>\n    message <span class=\"token operator\">=</span> MIMEText<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> <span class=\"token string\">'plain'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>\n    message<span class=\"token punctuation\">[</span><span class=\"token string\">'From'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Header<span class=\"token punctuation\">(</span><span class=\"token string\">\"1@example.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># 发件人邮箱</span>\n    message<span class=\"token punctuation\">[</span><span class=\"token string\">'To'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>  Header<span class=\"token punctuation\">(</span><span class=\"token string\">\"2@example.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 收件人邮箱</span>\n    subject <span class=\"token operator\">=</span> title\n    message<span class=\"token punctuation\">[</span><span class=\"token string\">'Subject'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> Header<span class=\"token punctuation\">(</span>subject<span class=\"token punctuation\">,</span> <span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># smtpObj = smtplib.SMTP()              # 使用一般发信</span>\n        <span class=\"token comment\"># smtpObj.connect(mail_host, 25)        # 不加密时 SMTP 端口号为 25</span>\n        <span class=\"token comment\"># smtpObj = smtplib.SMTP_SSL()          # Python 3.7 以下版本 SSL 加密发信</span>\n        smtpObj <span class=\"token operator\">=</span> smtplib<span class=\"token punctuation\">.</span>SMTP_SSL<span class=\"token punctuation\">(</span>mail_host<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># Python 3.7 及以上版本 SSL 加密发信</span>\n        smtpObj<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>mail_host<span class=\"token punctuation\">,</span> <span class=\"token number\">465</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 加密时 SMTP 端口号为 465</span>\n        smtpObj<span class=\"token punctuation\">.</span>login<span class=\"token punctuation\">(</span>mail_user<span class=\"token punctuation\">,</span>mail_pass<span class=\"token punctuation\">)</span>\n        smtpObj<span class=\"token punctuation\">.</span>sendmail<span class=\"token punctuation\">(</span>sender<span class=\"token punctuation\">,</span> receivers<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">.</span>as_string<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Success: The email was sent successfully\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> smtplib<span class=\"token punctuation\">.</span>SMTPException<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Error: Can not send mail\"</span><span class=\"token punctuation\">)</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n</details><br />\n<p>合理地偷个懒，需要修改的地方都在代码注释里了。</p>\n<h2 id=\"定时任务\"><a href=\"#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>定时任务</h2>\n<p>要想让代码实现自动打卡，还需要另外设置定时任务，Linux 可以用 <strong>crontab</strong>，Windows 可以用 <strong>任务计划程序</strong>。</p>\n<pre class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\"># Linux 下添加 crontab 定时命令，每天 8:00 执行打卡并输出日志到 .log 文件</span>\n<span class=\"token comment\"># 建议先运行测试是否可行</span>\n<span class=\"token comment\"># python3 auto-checkin.py</span>\n\n<span class=\"token function\">crontab</span> -e\n<span class=\"token number\">0</span> <span class=\"token number\">8</span> * * * root /path/to/python3 /path/to/auto-checkin.py <span class=\"token operator\">></span> /path/to/checkin.log\n<span class=\"token comment\"># :wq 保存并退出</span><span class=\"line-numbers-rows\" aria-hidden=\"true\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>Windows 下按 <code>win</code> 搜索“任务计划程序”调出菜单，然后在右栏选择创建基础任务。跟着创建基本任务向导的指示一步一步来就好了，「触发器 -> 每日」设置时间推荐避开 6:00 腐败街预约打卡的高峰，8:00 就不错。「操作 -> 启动程序」的程序或脚本项按下面格式填写。</p>\n<p><figure><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 870 686' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-779ae8e1118617cc54ca7e07fec05044'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-779ae8e1118617cc54ca7e07fec05044)' width='870' height='686' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAyCAIAAABj4UpDAAAACXBIWXMAAAsSAAALEgHS3X78AAAJVElEQVRo3u1Z%2bW8T2R13pf4d/R%2bqrfpLValdtVLbpb9UVaU9tGUFXdgSYHcrLW23QAMsbAjsbrqlkIUcEAhJ7CR2nDjxFdtx4tvja%2bL7Gp/je2Y84yuJ3e/MkEADm4SqglDlo%2bdvXt68mfc%2b73uOLcBxnKhUcvl8gUWxXC6XOBQ5VPcrKA75fF5QLhUUC3P3RseGh4eW9CtWq0WjWdRoFxcXVSarvdPptNvtzv5Dq9VKJBK1Wk1AUdVas1NrtGimtra2Xq/Xq1W62Ww2Go1Waw3239mXgGNdX19nGEZAV1IbuK6IhaulPH%2bl8yqAtwtWA0zOnV36q0E1Ew14YYgol7NZvFQuJRIYdIql8n4nQNN0LJk3mAyxWBSGnIhFMiNVyGdHHjwQTk7JFMqN9v4mwPkyHo1GwaNZ52g2wbDWWq16vcHUau39b0IQknYINe12%2b9UgsLGxwQ%2b1n8KrQeDlbqW941X%2bcPlpW33oPCJQqVTgD0gwegD0OR9Y2xWt1lZnD7OfdT8PXv98H4YhBUGHlWxnbcsunpCPiYEDC9wu%2b8jIgy%2bvXfv6X7empyZVKsXdu3dDkRhEJ2BF7IBKpcwBprEfDsTeQJIkxAwcz0HhYjIa7A4n3Asj2WwW1oUOW9EUS0SFsFvZqKhfXhYKx01m8%2bDgoFgsVioUoskpWAzqIEEqlSoU8pCWE1gin8/BI5KpFNy/6w5IggBdVWmaokiwQ1gYKpS97J7VOUP/44vev3x69sqVyx8c%2b8PxE13nzp873919/tzfpTOSj06f7L5w8dSpk2PCqXmx6Fe/%2bOVnly6//uMfdX1w/Afff%2b3QG4eOHH7v8LuHs7liPpcTmA3Lg4NDkxPj/bcH8HwRtgF62Xl5mmH8qOf%2byL2RERD3Bu8MSGUyjVpttTm25myT20CRxPjY6NS0RCgSoasogtiX9Xqj2ex0Os1mE8BoNGq1ukg0ZvU4J2RzOjtiRd2LZuPA6OiIWDolXxDKZEWayYEGQsGAHUHisVggECyVK%2bzB7sEACrmcd3U1FA4HAgGv1xfH4hiWgMzNl4o0zYAE/cBZMAzoBrRE8RUkb3VQ7XLVJEmyE1hADQbuRzN0bRONep2CG43m5ry8Kluoy1VNuWpNpakvKJh5OSWWkk4XXigIMtnsWquhVMjVWh2GJakqtaspA4FkKpHJZjAsHo5EstkMns1GIuFQMAiWCFSAFVzy%2bXzpTCYYDEGOB2PNsMhuum6rwZaL4KvNeoOLHptg/wE%2bNF1nmAZNZ776Ojwn887LzA8fmsYm7KLJsFIV1S1FRFOl4RG8XBZkWQJNC2jOYoFlYHO7EoCji8Wj4XDY6UBA3Q6Hw%2b1B7Xab2Wxxu12I0%2blxe/x%2bv9vlXFpaslhsTodj1et1uZweFN3gogeHda49C53OOkzrdCAopceFGEUag75BqeTu7JxIr7fE4vFmPZZKFUXTuWJR4PV6dfqVQDhSpWtgQKUKsXOrcGYNugctg97ZwrvOgj8%2bhoEoTPM%2bDYYBFkJzoDjLgk9lL9CvVBWqqlpDq7XlP/05030J77mOX%2bnNg/y8N3O5J9NzLX3m0/Kt2zhBCHwuq1wiRBFLs1ppMSS09RrZaVBPtzYna1XWhgr5XCgUisdjIEEVYCRgMOFwFKwEgmDliai6bW87hyeCpkkMy/fdSK4YUhptXKXOLRsyClVWqS7rlxOy%2bYxCmZyXl/SGnFhCPBjDSyXBhBnr1RWGrMUBI/7Alhu15m7qs1fVmd7F7e26JnNRkTaECq06HY2GxyfGp6ZEQ0ODA4PD6kXV3JxUOCVRKuUWqx1sbO85YRsBIhItDgy73C63YQW1mH0IYtMvozZ7OhJxGk0ukwm12TwIgsjmidFxHEzoN/9EBb93v9YX/eGN2E/64z%2b7g33vYlBwzPOdE6jgj//RvtuFCg67r8nTnSZZJiiwmhqXt3lrgS4J0ZEkd80hO8cHoljMPxRVpmWEZIGckVem5wjxPLTS1CwpWYAOKZkvT8sK94Vl7RJeKgr6lOF3xxJHx2NHJrD3hYljosRRrvN0Oy5KvDOKyTy59TqNxWOLGvXSkt4M7m82Ly5qDIYVjweNxbH/8vg3EwhE2ygkYpJiSwy%2bdth8r20/0a%2bvtwt0LYdnBeFVRDZ5XyuXrtepTpMz9%2bazWxtki2KqBFWlY%2bHQjHhapV70B/1Op2NlZVmj1ax6/eAG5LcQgJqDKzseFSD8dreKka0%2bBEEsk8%2bWqGp9jaq1oBF0g2SaJN0gNhsMFsl6oUywiSyOJeKJJJZMFUpEqcy24o6tzIUhiCr8iz/NJiyaC0h1mvu641uPlqpC7IIpYGwg%2bXAMT6huJj8wRzb9gRtAKKeqBFmFtUiKrjVaVaYOEhpTh7zRpNgFm2C6kAMEEDf4TPm8ut46uV0jDFyC58fj8XQqHY1ELFZrLBYvlkp4NiOVSiFjYBgWCvo1Gg1iRxwOF%2bTpVDIRDoWgSAv6fbe/6dfpdDdv3Xo4Ojp0p//6l32zM5K%2br/r8wUgJfCCdTj/v7p8XwLRRr1397MKp0x%2be677w4emTfzt7bk42399/8%2bKlS1C0dZ04cbWn58wnn5w9233mzJmJ8fHens%2b7uk7euPVNwOf99aE3enp63nz77cNHjr71u9/%2b9PWff/zxR2%2b%2b9Y7JaofDeREE2OhCEN5VFHK2B12FQsPtdoP6ggHInxE/ZBD24%2bPGPaFwJOBbFYslapVSrVlKJuJKlcqwsuJ0o3bEPiuRjI0LdTot1JHhSLRQKL4gAgCGcxT%2bhYmNuSTJ8CG4xmyBvboZlLnUTUNIAGfjwzVI/nUHngPykQ%2b8MAJP%2bskOlfaTE55O5I%2biFlfPwhGwLzQvjMD/HLDtAwIHBA4IAIFU6kADBwQOCBwQOCBwQOCAwAGB/xcClT2Pv2QC3E88j%2bTjEZKsUgS1bZCTVfIx%2bEvwzpnL5V4aAVg3lUqlOXA/HWTgv3wmZY/kZ5CU1pvV%2bnIaL842H77gzrjjhUwqkUgm4S54Fc5k0slkMhKJvBwCcIrRaGQVRW1mq9OBKJWK6WmxVDqXSiaMQXxWrnFYzUsa9cyMRCad8TjsjtXgih9PxKKxWPTe8PDIvRGT2QIH4PP7XxoB9susUNBmtaEoiiCI1WozW6xwxkBAYw%2b6vEGtCWGb0W51%2bQxozBTMJbEY3IXY7frlZY8HBVUEAoF/A7plcjGZ2sWXAAAAAElFTkSuQmCC' /%3e%3c/svg%3e\" width=\"870\" alt=\"Windows 定时任务设置\" data-srcset=\"/assets/static/heu-autotask.82a2fbd.22a101484c9f4d4a1d03d2ac7783f0f0.png 480w, /assets/static/heu-autotask.ae085b2.22a101484c9f4d4a1d03d2ac7783f0f0.png 870w\" data-sizes=\"(max-width: 870px) 100vw, 870px\" data-src=\"/assets/static/heu-autotask.ae085b2.22a101484c9f4d4a1d03d2ac7783f0f0.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/heu-autotask.ae085b2.22a101484c9f4d4a1d03d2ac7783f0f0.png\" width=\"870\" alt=\"Windows 定时任务设置\"></noscript><figcaption>Windows 定时任务设置</figcaption></figure></p>\n<p>Okay，睡个回笼觉庆祝一下 🥳..</p>\n<blockquote>\n<p>查看《<a href=\"https://blog.monsterx.cn/tech/modified-github-actions-4-heu-checkin/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">照葫芦画瓢 · 编写 Actions 打卡工作流</a>》了解 GitHub Actions 版本。</p>\n</blockquote>\n"}}]}}},"context":{}}